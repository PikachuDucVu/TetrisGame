/*! For license information please see main.d9b5a057.js.LICENSE.txt */
!function(){var t={7465:function(t){"use strict";var e,n="object"===typeof Reflect?Reflect:null,i=n&&"function"===typeof n.apply?n.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};e=n&&"function"===typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var r=Number.isNaN||function(t){return t!==t};function o(){o.init.call(this)}t.exports=o,t.exports.once=function(t,e){return new Promise((function(n,i){function r(n){t.removeListener(e,o),i(n)}function o(){"function"===typeof t.removeListener&&t.removeListener("error",r),n([].slice.call(arguments))}p(t,e,o,{once:!0}),"error"!==e&&function(t,e,n){"function"===typeof t.on&&p(t,"error",e,n)}(t,r,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(t){if("function"!==typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function h(t){return void 0===t._maxListeners?o.defaultMaxListeners:t._maxListeners}function u(t,e,n,i){var r,o,s,u;if(a(n),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]),void 0===s)s=o[e]=n,++t._eventsCount;else if("function"===typeof s?s=o[e]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),(r=h(t))>0&&s.length>r&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=s.length,u=l,console&&console.warn&&console.warn(u)}return t}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=l.bind(i);return r.listener=n,i.wrapFn=r,r}function f(t,e,n){var i=t._events;if(void 0===i)return[];var r=i[e];return void 0===r?[]:"function"===typeof r?n?[r.listener||r]:[r]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(r):d(r,r.length)}function v(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function d(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function p(t,e,n,i){if("function"===typeof t.on)i.once?t.once(e,n):t.on(e,n);else{if("function"!==typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function r(o){i.once&&t.removeEventListener(e,r),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(t){if("number"!==typeof t||t<0||r(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");s=t}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(t){if("number"!==typeof t||t<0||r(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},o.prototype.getMaxListeners=function(){return h(this)},o.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var h=o[t];if(void 0===h)return!1;if("function"===typeof h)i(h,this,e);else{var u=h.length,l=d(h,u);for(n=0;n<u;++n)i(l[n],this,e)}return!0},o.prototype.addListener=function(t,e){return u(this,t,e,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(t,e){return u(this,t,e,!0)},o.prototype.once=function(t,e){return a(e),this.on(t,c(this,t,e)),this},o.prototype.prependOnceListener=function(t,e){return a(e),this.prependListener(t,c(this,t,e)),this},o.prototype.removeListener=function(t,e){var n,i,r,o,s;if(a(e),void 0===(i=this._events))return this;if(void 0===(n=i[t]))return this;if(n===e||n.listener===e)0===--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!==typeof n){for(r=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){s=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,r),1===n.length&&(i[t]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",t,s||e)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(t){var e,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var r,o=Object.keys(n);for(i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},o.prototype.listeners=function(t){return f(this,t,!0)},o.prototype.rawListeners=function(t){return f(this,t,!1)},o.listenerCount=function(t,e){return"function"===typeof t.listenerCount?t.listenerCount(e):v.call(t,e)},o.prototype.listenerCount=v,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},9054:function(t,e,n){"use strict";var i,r=n(4704).default,o=n(6690).default,s=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Animation=e.PlayMode=void 0,function(t){t[t.NORMAL=0]="NORMAL",t[t.LOOP=1]="LOOP",t[t.LOOP_PINGPONG=2]="LOOP_PINGPONG",t[t.REVERSED=3]="REVERSED",t[t.LOOP_REVERSED=4]="LOOP_REVERSED"}(i=e.PlayMode||(e.PlayMode={}));var a=function(){function t(e,n){o(this,t),this.totalDuration=0,this.keyFrames=e,Array.isArray(n)||(n=[n]);for(var i=n[n.length-1]||0;n.length<e.length;)n.push(i);var s,a=r(n);try{for(a.s();!(s=a.n()).done;){var h=s.value;this.totalDuration+=h}}catch(u){a.e(u)}finally{a.f()}this.frameDurations=n}return s(t,[{key:"getFrameNumber",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.frameDurations,i=e?n.length-1:0;!((t-=n[i])<0);)e?i--:i++;return i}},{key:"getKeyFrame",value:function(t,e){var n=this.keyFrames,r=this.frameDurations,o=this.totalDuration,s=Math.floor(t/o),a=t%o,h=0;switch(e){case i.NORMAL:h=0===s?this.getFrameNumber(a):r.length-1;break;case i.LOOP:h=this.getFrameNumber(a);break;case i.LOOP_PINGPONG:h=this.getFrameNumber(a,s%2===1);break;case i.REVERSED:h=0===s?this.getFrameNumber(a,!0):0;break;case i.LOOP_REVERSED:h=this.getFrameNumber(a,!0)}return n[h]}}]),t}();e.Animation=a},7035:function(t,e,n){"use strict";var i=n(861).default,r=n(7061).default,o=n(4704).default,s=n(6690).default,a=n(9728).default,h=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{h(i.next(t))}catch(e){o(e)}}function a(t){try{h(i.throw(t))}catch(e){o(e)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}h((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.AssetManager=void 0;var u=n(5283),l=n(3432),c=n(8143),f=function(){function t(e){s(this,t),this.promises=[],this.atlases=new Map,this.textures=new Map,this.jsonData=new Map,this.binaryData=new Map,this.done=0,this.listeners=[],this.fonts=new Map,this.gl=e}return a(t,[{key:"addListener",value:function(t){this.listeners.push(t)}},{key:"reportDone",value:function(){this.done++;var t,e=o(this.listeners);try{for(e.s();!(t=e.n()).done;){(0,t.value)(this.done/this.getTotal()*100,this.done>=this.getTotal())}}catch(n){e.e(n)}finally{e.f()}}},{key:"loadAtlas",value:function(t,e){var n=this,i=c.TextureAtlas.load(this.gl,t,{}).then((function(t){return n.atlases.set(e,t),n.reportDone(),t}));return this.promises.push(i),i}},{key:"getAtlas",value:function(t){return this.atlases.get(t)}},{key:"loadJsonData",value:function(t,e){var n=this,i=fetch(t).then((function(t){return t.json()})).then((function(t){return n.jsonData.set(e,t),n.reportDone(),t}));return this.promises.push(i),i}},{key:"getJsonData",value:function(t){return this.jsonData.get(t)}},{key:"loadBinaryData",value:function(t,e){var n=this,i=fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return n.binaryData.set(e,t),n.reportDone(),t}));return this.promises.push(i),i}},{key:"getBinaryData",value:function(t){return this.binaryData.get(t)}},{key:"loadFont",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=u.BitmapFont.load(this.gl,t,i).then((function(t){return n.fonts.set(e,t),n.reportDone(),t}));return this.promises.push(r),r}},{key:"getFont",value:function(t){return this.fonts.get(t)}},{key:"loadTexture",value:function(t,e){var n=this,i=l.Texture.load(this.gl,t).then((function(t){return n.textures.set(e,t),n.reportDone(),t}));return this.promises.push(i),i}},{key:"getTexture",value:function(t){return this.textures.get(t)}},{key:"finishLoading",value:function(){return h(this,void 0,void 0,r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.promises);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"getDone",value:function(){return this.done}},{key:"getTotal",value:function(){return this.promises.length}},{key:"disposeAll",value:function(){var t=this;i(this.atlases.keys()).forEach((function(e){var n;((null===(n=t.atlases.get(e))||void 0===n?void 0:n.getRegions())||[]).forEach((function(t){var e;null===(e=t.texture)||void 0===e||e.destroy()})),t.atlases.delete(e)})),i(this.textures.keys()).forEach((function(e){var n;null===(n=t.textures.get(e))||void 0===n||n.destroy(),t.textures.delete(e)})),i(this.fonts.keys()).forEach((function(e){var n;((null===(n=t.fonts.get(e))||void 0===n?void 0:n.getRegions())||[]).forEach((function(t){var e;null===(e=t.texture)||void 0===e||e.destroy()})),t.fonts.delete(e)}))}}]),t}();e.AssetManager=f,e.default=f},5283:function(t,e,n){"use strict";var i=n(7061).default,r=n(9728).default,o=n(6690).default,s=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{h(i.next(t))}catch(e){o(e)}}function a(t){try{h(i.throw(t))}catch(e){o(e)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}h((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.BitmapFont=void 0;var a=n(6735),h=n(909),u=n(8637),l=r((function t(e,n,i){var r=this;o(this,t),this.load=function(t){for(var e=Object.values(t.glyphs),n=0;n<e.length;n++){var i=e[n];if(i)for(var o=0;o<i.length;o++){var s=i[o];s&&t.setGlyphRegion(s,r.regions[s.page])}}null!=t.missingGlyph&&t.setGlyphRegion(t.missingGlyph,r.regions[t.missingGlyph.page])},this.draw=function(t,e,n,i,o){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:u.Align.left,a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:e.length,c=arguments.length>9?arguments[9]:void 0;r.cache.clear(),r.cache.addText(e,n,i,h,l,o,s,a,c),r.cache.draw(t)},this.getColor=function(){return r.cache.getColor()},this.getScaleX=function(){return r.data.scaleX},this.getScaleY=function(){return r.data.scaleY},this.getRegions=function(){return r.regions},this.getRegion=function(t){return r.regions[t]},this.getLineHeight=function(){return r.data.lineHeight},this.getSpaceXadvance=function(){return r.data.spaceXadvance},this.getXHeight=function(){return r.data.xHeight},this.getCapHeight=function(){return r.data.capHeight},this.getAscent=function(){return r.data.ascent},this.getDescent=function(){return r.data.descent},this.isFlipped=function(){return r.flipped},this.dispose=function(){if(r.ownsTexture)for(var t=0;t<r.regions.length;t++)r.regions[t].texture.dispose()},this.setFixedWidthGlyphs=function(t){for(var e=r.data,n=0,i=0,o=t.length;i<o;i++){var s=e.getGlyph(t.charAt(i));null!=s&&s.xadvance>n&&(n=s.xadvance)}for(var a=0,h=t.length;a<h;a++){var u=e.getGlyph(t.charAt(a));u&&(u.xoffset+=(n-u.xadvance)/2,u.xadvance=n,u.kerning=[],u.kerning=null,u.fixedWidth=!0)}},this.setUseIntegerPositions=function(t){r.integer=t,r.cache.setUseIntegerPositions(t)},this.usesIntegerPositions=function(){return r.integer},this.getCache=function(){return r.cache},this.getData=function(){return r.data},this.getOwnsTexture=function(){return r.ownsTexture},this.setOwnsTexture=function(t){r.ownsTexture=t},this.newFontCache=function(){return new a.BitmapFontCache(r,r.integer)},this.regions=n,this.flipped=e.flipped,this.data=e,this.integer=i,0!==this.regions.length?(this.ownsTexture=!1,this.cache=this.newFontCache(),this.load(e)):console.log("No texture region were found")}));e.BitmapFont=l,l.load=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return s(void 0,void 0,void 0,i().mark((function o(){var s;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return s=new h.BitmapFontData(e,n),i.next=3,s.loadFont(t);case 3:return i.abrupt("return",new l(s,s.regions,r));case 4:case"end":return i.stop()}}),o)})))}},6735:function(t,e,n){"use strict";var i=n(861).default,r=n(6690).default,o=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.BitmapFontCache=void 0;var s=n(417),a=n(2226),h=n(8637),u=function(){function t(e,n){var o=this;r(this,t),this.tempColor=new h.Color(1,1,1,1),this.drawingTexts=[],this.layouts=[],this.pooledLayouts=[],this.color=new h.Color(1,1,1,1),this.setPosition=function(t,e){o.translate(t-o.x,e-o.y)},this.translate=function(t,e){if(0!==t||0!==e){o.integer&&(t=Math.round(t),e=Math.round(e)),o.x+=t,o.y+=e;for(var n=o.pageVertices,i=0,r=n.length;i<r;i++)for(var s=n[i],a=0,h=o.idx[i];a<h;a+=5)s[a]+=t,s[a+1]+=e}},this.setColors=function(t,e,n,i){for(var r=255<<24|255*n<<16|255*e<<8|255*t,s=a.NumberUtil.intToFloatColor(r),h=0,u=o.pageVertices.length;h<u;h++)for(var l=o.pageVertices[h],c=2,f=o.idx[h];c<f;c+=5)l[c]=s},this.getColor=function(){return o.color},this.setColor=function(t,e,n,i){o.color.set(t,e,n,i)},this.clear=function(){o.x=0,o.y=0,h.Pools.freeAll("GlyphLayout",o.pooledLayouts),o.pooledLayouts.length=0,o.layouts.length=0;for(var t=0,e=o.idx.length;t<e;t++)null!=o.pageGlyphIndices&&(o.pageGlyphIndices[t].length=0),o.idx[t]=0},this.requireGlyphs=function(t){if(1===o.pageVertices.length)o.requirePageGlyphs(0,t.glyphCount);else{for(var e=o.tempGlyphCount,n=0;n<e.length;n++)e[n]=0;for(var i=0,r=t.runs.length;i<r;i++)for(var s=t.runs[i].glyphs,a=s,h=0,u=s.length;h<u;h++)e[a[h].page]++;for(var l=0,c=e.length;l<c;l++)o.requirePageGlyphs(l,e[l])}},this.requirePageGlyphs=function(t,e){var n=o.idx[t]+20*e,i=o.pageVertices[t];if(i){if(i.length<n){var r=new Array(n);h.Utils.arrayCopy(i,0,r,0,o.idx[t]),o.pageVertices[t]=r}}else o.pageVertices[t]=new Array(n)},this.setPageCount=function(t){var e=new Array(t).fill([]);h.Utils.arrayCopy(o.pageVertices,0,e,0,o.pageVertices.length),o.pageVertices=i(e);var n=new Array(t);h.Utils.arrayCopy(o.idx,0,n,0,o.idx.length),o.idx=n;var r=new Array(t),s=0;null!=o.pageGlyphIndices&&(s=o.pageGlyphIndices.length,h.Utils.arrayCopy(o.pageGlyphIndices,0,r,0,o.pageGlyphIndices.length));for(var a=s;a<t;a++)r[a]=[];o.pageGlyphIndices=r,o.tempGlyphCount=new Array(t)},this.addToCache=function(t,e,n){var i=t.runs.length;if(0!==i){o.pageVertices.length<o.font.regions.length&&o.setPageCount(o.font.regions.length),o.layouts.push(t),o.requireGlyphs(t);var r=t.colors,s=0,h=0,u=0,l=0;o.drawingTexts.length=0;for(var c=0;c<i;c++)for(var f=t.runs[c],v=f.glyphs,d=f.xAdvances,p=e+f.x,y=n+f.y,M=0,g=f.glyphs.length;M<g;M++)u++===h&&(l=a.NumberUtil.intToFloatColor(r[++s]),h=++s<r.length?r[s]:-1),p+=d[M],o.drawingTexts.push(v[M].id),o.addGlyph(v[M],p,y,l);o.currentTint=a.NumberUtil.intToFloatColor(-1)}},this.addGlyph=function(t,e,n,i){var r=o.font.data.scaleX,s=o.font.data.scaleY;e+=t.xoffset*r,n+=t.yoffset*s;var a=t.width*r,h=t.height*s,u=t.u,l=t.u2,c=t.v,f=t.v2;o.integer&&(e=Math.round(e),n=Math.round(n),a=Math.round(a),h=Math.round(h));var v=e+a,d=n+h,p=t.page,y=o.idx[p];o.idx[p]+=20,null!=o.pageGlyphIndices&&o.pageGlyphIndices[p].push(o.glyphCount++);var M=o.pageVertices[p];M[y++]=e,M[y++]=n,M[y++]=i,M[y++]=u,M[y++]=c,M[y++]=e,M[y++]=d,M[y++]=i,M[y++]=u,M[y++]=f,M[y++]=v,M[y++]=d,M[y++]=i,M[y++]=l,M[y++]=f,M[y++]=v,M[y++]=n,M[y++]=i,M[y++]=l,M[y]=c},this.setText=function(t,e,n,i,r,s,a,h,u){return o.clear(),o.addText(t,e,n,i,r,s,a,h,u)},this.setTextToCache=function(t,e,n){o.clear(),o.addTextToCache(t,e,n)},this.addText=function(t,e,n,i,r,s,a,u,l){var c=h.Pools.obtain("GlyphLayout");return o.pooledLayouts.push(c),c.setText(o.font,t,i,r,o.color,s,a,u,l),o.addTextToCache(c,e,n),c},this.addTextToCache=function(t,e,n){o.addToCache(t,e,n+o.font.data.ascent)},this.getX=function(){return o.x},this.getY=function(){return o.y},this.getFont=function(){return o.font},this.setUseIntegerPositions=function(t){o.integer=t},this.usesIntegerPositions=function(){return o.integer},this.getVertices=function(t){return o.pageVertices[t]},this.getVertexCount=function(t){return o.idx[t]},this.getLayouts=function(){return o.layouts},this.font=e,this.integer=n;var u=e.regions.length;if(0===u&&console.log("The specified font must contain at least one texture page."),this.pageVertices=new Array(u).fill([]),this.idx=new Array(u),u>1){this.pageGlyphIndices=new Array(u);for(var l=0,c=this.pageGlyphIndices.length;l<c;l++)this.pageGlyphIndices[l]=[]}this.tempGlyphCount=new Array(u),h.Pools.get("GlyphLayout",(function(){return new s.GlyphLayout(e,"",0,0,h.Color.WHITE,0,h.Align.left,!1)}))}return o(t,[{key:"draw",value:function(t){for(var e=this,n=this.font.getRegions(),i=0;i<this.pageVertices.length;i++)if(this.idx[i]>0)for(var r=this.pageVertices[i],o=function(i){var o=20*i,s=n.find((function(t){var n;return t.id===(null===(n=e.drawingTexts)||void 0===n?void 0:n[i])}));s&&s.draw(t,r[0+o],r[1+o],r[10+o]-r[0+o],r[11+o]-r[1+o])},s=0;s<this.idx[i]/20;s++)o(s)}}]),t}();e.BitmapFontCache=u},909:function(t,e,n){"use strict";var i=n(861).default,r=n(7061).default,o=n(6690).default,s=n(9728).default,a=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{h(i.next(t))}catch(e){o(e)}}function a(t){try{h(i.throw(t))}catch(e){o(e)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}h((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.BitmapFontData=void 0;var h=n(5508),u=n(3432),l=n(8026);function c(t,e){for(var n=t.split("/"),i=e.split("/"),r=[],o=0,s=n.length;o<s;o++)if(".."===n[o])r.pop();else{if("."===n[o])continue;r.push(n[o])}for(var a=0,h=i.length;a<h;a++)if(".."===i[a])r.pop();else{if("."===i[a])continue;r.push(i[a])}return r.join("/")}var f=65535,v=function(){function t(e,n){var i=this;o(this,t),this.capHeight=1,this.blankLineScale=1,this.scaleX=1,this.scaleY=1,this.glyphs={},this.xHeight=1,this.xChars=["x","e","a","o","n","s","r","c","u","m","v","w","z"],this.capChars=["M","N","B","D","C","E","F","K","A","G","H","I","J","L","O","P","Q","R","S","T","U","V","W","X","Y","Z"],this.loadFont=function(t){return a(i,void 0,void 0,r().mark((function e(){var n,i,o,s,a,v,p,y,M,g,x,m,w,k,b,_,T,E,A,L,P,C,S,O,R,I,V,F,G,D,z,j,B,N,U,X,H,W,Y,Z,q,K,Q,J,$,tt,et,nt,it,rt,ot,st,at,ht,ut,lt,ct,ft,vt,dt,pt,yt,Mt,gt,xt,mt;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.imagePaths){e.next=2;break}return e.abrupt("return");case 2:return n=0,e.next=5,fetch(this.fontFile);case 5:return o=e.sent,e.next=8,o.text();case 8:if(i=e.sent,s=i.split(/\r?\n/).map((function(t){return t.trim()})),e.prev=10,"string"===typeof(a=s[n])){e.next=14;break}throw new Error("File is empty.");case 14:if(a=a.substring(a.indexOf("padding=")+8),4===(v=a.substring(0,a.indexOf(" ")).split(",",4)).length){e.next=18;break}throw new Error("Invalid padding.");case 18:if(this.padTop=parseInt(v[0]),this.padRight=parseInt(v[1]),this.padBottom=parseInt(v[2]),this.padLeft=parseInt(v[3]),p=this.padTop+this.padBottom,n++,"string"===typeof(a=s[n])){e.next=27;break}throw new Error("Missing common header.");case 27:if(!((y=a.split(" ",9)).length<3)){e.next=30;break}throw new Error("Invalid common header.");case 30:if(y[1].startsWith("lineHeight=")){e.next=32;break}throw new Error("Missing: lineHeight");case 32:if(this.lineHeight=parseInt(y[1].substring(11)),y[2].startsWith("base=")){e.next=35;break}throw new Error("Missing: base");case 35:if(M=parseInt(y[2].substring(5)),g=1,y.length>=6&&null!=y[5]&&y[5].startsWith("pages="))try{g=Math.max(1,parseInt(y[5].substring(6)))}catch(r){}this.imagePaths=new Array(g),x=[],m=0;case 41:if(!(m<g)){e.next=65;break}if(n++,"string"===typeof(a=s[n])){e.next=46;break}throw new Error("Missing additional page definitions.");case 46:if(!((w=a.match(new RegExp(".*id=(\\d+)")))&&w.length>1)){e.next=57;break}if(k=w[1],e.prev=49,parseInt(k)===m){e.next=53;break}throw new Error("Page IDs must be indices starting at 0: "+k);case 53:e.next=57;break;case 55:e.prev=55,e.t0=e.catch(49);case 57:if((b=a.match(new RegExp('.*file="?([^"]+)"?')))&&!(b.length<=1)){e.next=60;break}throw new Error("Missing: file");case 60:_=b[1],x[m]=_;case 62:m++,e.next=41;break;case 65:this.descent=0;case 66:if(n++,a=s[n]){e.next=71;break}return e.abrupt("break",105);case 71:if(!a.startsWith("kernings ")){e.next=73;break}return e.abrupt("break",105);case 73:if(!a.startsWith("metrics ")){e.next=75;break}return e.abrupt("break",105);case 75:if(a.startsWith("char ")){e.next=77;break}return e.abrupt("continue",66);case 77:if(T=new h.Glyph,(E=new d(a,"=")).nextToken(),E.nextToken(),!((A=parseInt(E.nextToken()))>0&&A>f)){e.next=84;break}return e.abrupt("continue",66);case 84:if(T.id=A+"",E.nextToken(),T.srcX=parseInt(E.nextToken()),E.nextToken(),T.srcY=parseInt(E.nextToken()),E.nextToken(),T.width=parseInt(E.nextToken()),E.nextToken(),T.height=parseInt(E.nextToken()),E.nextToken(),T.xoffset=parseInt(E.nextToken()),E.nextToken(),this.flipped?T.yoffset=parseInt(E.nextToken()):T.yoffset=-(T.height+parseInt(E.nextToken())),E.nextToken(),T.xadvance=parseInt(E.nextToken()),E.hasMoreTokens()&&E.nextToken(),E.hasMoreTokens())try{T.page=parseInt(E.nextToken())}catch(wt){}T.width>0&&T.height>0&&(this.descent=Math.min(M+T.yoffset,this.descent)),A<=0?this.missingGlyph=T:A<=f&&this.setGlyph(A,T),e.next=66;break;case 105:this.descent+=this.padBottom;case 106:if(n++,"string"===typeof(a=s[n])){e.next=111;break}return e.abrupt("break",127);case 111:if(a.startsWith("kerning ")){e.next=113;break}return e.abrupt("break",127);case 113:if((L=new d(a,"=")).nextToken(),L.nextToken(),P=parseInt(L.nextToken()),L.nextToken(),C=parseInt(L.nextToken()),!(P<0||P>f||C<0||C>f)){e.next=121;break}return e.abrupt("continue",106);case 121:S=this.getGlyph(P+""),L.nextToken(),O=parseInt(L.nextToken()),S&&S.setKerning(C,O),e.next=106;break;case 127:R=!1,I=0,V=0,F=0,G=0,D=0,z=0,j=0,null!=a&&a.startsWith("metrics ")&&(R=!0,(B=new d(a,"=")).nextToken(),B.nextToken(),I=parseFloat(B.nextToken()),B.nextToken(),V=parseFloat(B.nextToken()),B.nextToken(),F=parseFloat(B.nextToken()),B.nextToken(),G=parseFloat(B.nextToken()),B.nextToken(),D=parseFloat(B.nextToken()),B.nextToken(),z=parseFloat(B.nextToken()),B.nextToken(),j=parseFloat(B.nextToken())),(N=this.getGlyph("32"))||((N=new h.Glyph).id="32",(U=this.getGlyph("l"))||(U=this.getFirstGlyph()),N.xadvance=U.xadvance,this.setGlyph(32,N)),0===N.width&&(N.width=this.padLeft+N.xadvance+this.padRight,N.xoffset=-this.padLeft),this.spaceXadvance=N.xadvance,H=0;case 141:if(!(H<this.xChars.length)){e.next=148;break}if(!(X=this.getGlyph(this.xChars[H]))){e.next=145;break}return e.abrupt("break",148);case 145:H++,e.next=141;break;case 148:X||(X=this.getFirstGlyph()),this.xHeight=X.height-p,Y=0;case 151:if(!(Y<this.capChars.length)){e.next=158;break}if(!(W=this.getGlyph(this.capChars[Y]))){e.next=155;break}return e.abrupt("break",158);case 155:Y++,e.next=151;break;case 158:if(W){e.next=178;break}Z=Object.values(this.glyphs),q=0;case 161:if(!(q<Z.length)){e.next=176;break}if(K=Z[q]){e.next=165;break}return e.abrupt("continue",173);case 165:Q=0;case 166:if(!(Q<K.length)){e.next=173;break}if(K[Q]&&0!==K[Q].height&&0!==K[Q].width){e.next=169;break}return e.abrupt("continue",170);case 169:this.capHeight=Math.max(this.capHeight,K[Q].height);case 170:Q++,e.next=166;break;case 173:q++,e.next=161;break;case 176:e.next=179;break;case 178:this.capHeight=W.height;case 179:for(this.capHeight-=p,this.ascent=M-this.capHeight,this.down=-this.lineHeight,this.flipped&&(this.ascent=-this.ascent,this.down=-this.down),R&&(this.ascent=I,this.descent=V,this.down=F,this.capHeight=G,this.lineHeight=D,this.spaceXadvance=z,this.xHeight=j),J=[],$=Object.values(this.glyphs),tt=0;tt<$.length;tt++)for(et=Object.values($[tt]),nt=0;nt<et.length;nt++)it={id:et[nt].id,left:et[nt].srcX,top:et[nt].srcY,width:et[nt].width,height:et[nt].height,xoffset:et[nt].xoffset,yoffset:et[nt].yoffset,xadvance:et[nt].xadvance,page:x[et[nt].page],pageId:et[nt].page},J.push(it);rt=[],ot=0;case 189:if(!(ot<g)){e.next=199;break}return e.next=192,u.Texture.load(t,c(this.fontFile,"../".concat(x[ot])));case 192:st=e.sent,at=1/st.width,ht=1/st.height,rt.push({texture:st,invTexWidth:at,invTexHeight:ht});case 196:ot++,e.next=189;break;case 199:for(this.regions=[],ut=0,lt=J;ut<lt.length;ut++)ct=lt[ut],ft=ct.left,vt=ct.top,dt=ct.width,pt=ct.height,yt=rt[ct.pageId],Mt=yt.texture,gt=yt.invTexWidth,xt=yt.invTexHeight,(mt=new l.TextureRegion(Mt,ft,vt,dt,pt,ct,gt,xt)).originalWidth=dt,mt.originalHeight=pt,mt.offsetX=0,mt.offsetY=0,this.regions.push(mt);e.next=206;break;case 203:e.prev=203,e.t1=e.catch(10),console.error(e.t1);case 206:case"end":return e.stop()}}),e,this,[[10,203],[49,55]])})))},this.setGlyphRegion=function(t,e){var n=e.texture,r=1/n.width,o=1/n.height,s=e.u,a=e.v,h=(e.originalWidth,e.originalHeight,t.srcX),u=t.srcX+t.width,l=t.srcY,c=t.srcY+t.height;t.u=s+h*r,t.u2=s+u*r,i.flipped?(t.v=a+l*o,t.v2=a+c*o):(t.v2=a+l*o,t.v=a+c*o)},this.setLineHeight=function(t){i.lineHeight=t*i.scaleY,i.down=i.flipped?i.lineHeight:-i.lineHeight},this.setGlyph=function(t,e){var n=i.glyphs[t/h.PAGE_SIZE];n||(n=new Array(h.PAGE_SIZE),i.glyphs[t/h.PAGE_SIZE]=n),n[t&h.PAGE_SIZE-1]=e},this.getFirstGlyph=function(){for(var t=Object.values(i.glyphs),e=0;e<t.length;e++){var n=t[e];if(n)for(var r=0;r<n.length;r++){var o=n[r];if(o&&0!==o.height&&0!==o.width)return o}}},this.hasGlyph=function(t){return!!i.missingGlyph||null!=i.getGlyph(t)},this.getGlyph=function(t){var e=i.glyphs[t.charCodeAt(0)/h.PAGE_SIZE];if(null!=e)return e[t.charCodeAt(0)&h.PAGE_SIZE-1]},this.getGlyphs=function(t,e,n,r,o){if(0!==r-n){var s=i.markupEnabled,a=i.scaleX,h=t.glyphs,u=t.xAdvances;do{var l=e.charAt(n++);if("\r"!==l){var c=i.getGlyph(l);if(!c){if(!i.missingGlyph)continue;c=i.missingGlyph}h.push(c),u.push(o?(o.xadvance+o.getKerning(l))*a:c.fixedWidth?0:-c.xoffset*a-i.padLeft),o=c,s&&"["===l&&n<r&&"["===e.charAt(n)&&n++}}while(n<r);if(o){var f=o.fixedWidth?o.xadvance*a:(o.width+o.xoffset)*a-i.padRight;u.push(f)}}},this.getWrapIndex=function(t,e){var n=e-1,r=t,o=r[n].id;if(i.isWhitespace(o+""))return n;for(i.isBreakChar(o+"")&&n--;n>0;n--)if(o=r[n].id,i.isWhitespace(o+"")||i.isBreakChar(o+""))return n+1;return 0},this.isBreakChar=function(t){if(!i.breakChars)return!1;for(var e=String.fromCharCode(parseInt(t)),n=0;n<i.breakChars.length;n++)if(e===i.breakChars[n])return!0;return!1},this.isWhitespace=function(t){switch(String.fromCharCode(parseInt(t))){case"\n":case"\r":case"\t":case" ":return!0;default:return!1}},this.getImagePath=function(t){return i.imagePaths[t]},this.getImagePaths=function(){return i.imagePaths},this.setScale=function(t,e){if(0!==t&&0!==e){var n=t/i.scaleX,r=e/i.scaleY;i.lineHeight*=r,i.spaceXadvance*=n,i.xHeight*=r,i.capHeight*=r,i.ascent*=r,i.descent*=r,i.down*=r,i.padLeft*=n,i.padRight*=n,i.padTop*=r,i.padBottom*=r,i.scaleX=t,i.scaleY=e}},this.scale=function(t){i.setScale(i.scaleX+t,i.scaleY+t)},this.fontFile=e,this.flipped=n}return s(t,[{key:"setXYScale",value:function(t){this.setScale(t,t)}}]),t}();e.BitmapFontData=v;var d=function(){function t(e,n){o(this,t),this.strArray=[],this.currentIndex=0;for(var r=e.split(/\s+/),s=0;s<r.length;s++){var a,h=r[s];(a=this.strArray).push.apply(a,i(h.split(n)))}}return s(t,[{key:"hasMoreTokens",value:function(){return this.currentIndex>=this.strArray.length}},{key:"nextToken",value:function(){return this.strArray[this.currentIndex++]}}]),t}()},2691:function(t,e,n){"use strict";var i=n(4704).default,r=n(6690).default,o=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.BoundingBox=void 0;var s=n(2668),a=function(){function t(){r(this,t),this.min=new s.Vector3,this.max=new s.Vector3,this.cnt=new s.Vector3,this.dim=new s.Vector3,this.clr()}return o(t,[{key:"getCenter",value:function(t){return t.setFrom(this.cnt)}},{key:"getCenterX",value:function(){return this.cnt.x}},{key:"getCenterY",value:function(){return this.cnt.y}},{key:"getCenterZ",value:function(){return this.cnt.z}},{key:"getCorner000",value:function(t){return t.set(this.min.x,this.min.y,this.min.z)}},{key:"getCorner001",value:function(t){return t.set(this.min.x,this.min.y,this.max.z)}},{key:"getCorner010",value:function(t){return t.set(this.min.x,this.max.y,this.min.z)}},{key:"getCorner011",value:function(t){return t.set(this.min.x,this.max.y,this.max.z)}},{key:"getCorner100",value:function(t){return t.set(this.max.x,this.min.y,this.min.z)}},{key:"getCorner101",value:function(t){return t.set(this.max.x,this.min.y,this.max.z)}},{key:"getCorner110",value:function(t){return t.set(this.max.x,this.max.y,this.min.z)}},{key:"getCorner111",value:function(t){return t.set(this.max.x,this.max.y,this.max.z)}},{key:"getDimensions",value:function(t){return t.setFrom(this.dim)}},{key:"getWidth",value:function(){return this.dim.x}},{key:"getHeight",value:function(){return this.dim.y}},{key:"getDepth",value:function(){return this.dim.z}},{key:"getMin",value:function(t){return t.setFrom(this.min)}},{key:"getMax",value:function(t){return t.setFrom(this.max)}},{key:"setFromBounds",value:function(t){return this.set(t.min,t.max)}},{key:"set",value:function(t,e){return this.min.set(t.x<e.x?t.x:e.x,t.y<e.y?t.y:e.y,t.z<e.z?t.z:e.z),this.max.set(t.x>e.x?t.x:e.x,t.y>e.y?t.y:e.y,t.z>e.z?t.z:e.z),this.update(),this}},{key:"update",value:function(){this.cnt.setFrom(this.min).add(this.max).scale(.5),this.dim.setFrom(this.max).sub(this.min)}},{key:"setFromPoints",value:function(t){this.inf();var e,n=i(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.extPoint(r)}}catch(o){n.e(o)}finally{n.f()}return this}},{key:"inf",value:function(){return this.min.set(1/0,1/0,1/0),this.max.set(-1/0,-1/0,-1/0),this.cnt.set(0,0,0),this.dim.set(0,0,0),this}},{key:"extPoint",value:function(t){return this.set(this.min.set(Math.min(this.min.x,t.x),Math.min(this.min.y,t.y),Math.min(this.min.z,t.z)),this.max.set(Math.max(this.max.x,t.x),Math.max(this.max.y,t.y),Math.max(this.max.z,t.z)))}},{key:"clr",value:function(){return this.set(this.min.set(0,0,0),this.max.set(0,0,0))}},{key:"isValid",value:function(){return this.min.x<=this.max.x&&this.min.y<=this.max.y&&this.min.z<=this.max.z}},{key:"extBounds",value:function(t){return this.set(this.min.set(Math.min(this.min.x,t.min.x),Math.min(this.min.y,t.min.y),Math.min(this.min.z,t.min.z)),this.max.set(Math.max(this.max.x,t.max.x),Math.max(this.max.y,t.max.y),Math.max(this.max.z,t.max.z)))}},{key:"extSphere",value:function(t,e){return this.set(this.min.set(Math.min(this.min.x,t.x-e),Math.min(this.min.y,t.y-e),Math.min(this.min.z,t.z-e)),this.max.set(Math.max(this.max.x,t.x+e),Math.max(this.max.y,t.y+e),Math.max(this.max.z,t.z+e)))}},{key:"extTransformedBox",value:function(e,n){return this.extPoint(t.tmpVector.set(e.min.x,e.min.y,e.min.z).multiply(n)),this.extPoint(t.tmpVector.set(e.min.x,e.min.y,e.max.z).multiply(n)),this.extPoint(t.tmpVector.set(e.min.x,e.max.y,e.min.z).multiply(n)),this.extPoint(t.tmpVector.set(e.min.x,e.max.y,e.max.z).multiply(n)),this.extPoint(t.tmpVector.set(e.max.x,e.min.y,e.min.z).multiply(n)),this.extPoint(t.tmpVector.set(e.max.x,e.min.y,e.max.z).multiply(n)),this.extPoint(t.tmpVector.set(e.max.x,e.max.y,e.min.z).multiply(n)),this.extPoint(t.tmpVector.set(e.max.x,e.max.y,e.max.z).multiply(n)),this}},{key:"mul",value:function(e){var n=this.min.x,i=this.min.y,r=this.min.z,o=this.max.x,s=this.max.y,a=this.max.z;return this.inf(),this.extPoint(t.tmpVector.set(n,i,r).multiply(e)),this.extPoint(t.tmpVector.set(n,i,a).multiply(e)),this.extPoint(t.tmpVector.set(n,s,r).multiply(e)),this.extPoint(t.tmpVector.set(n,s,a).multiply(e)),this.extPoint(t.tmpVector.set(o,i,r).multiply(e)),this.extPoint(t.tmpVector.set(o,i,a).multiply(e)),this.extPoint(t.tmpVector.set(o,s,r).multiply(e)),this.extPoint(t.tmpVector.set(o,s,a).multiply(e)),this}},{key:"containsBounds",value:function(t){return!this.isValid()||this.min.x<=t.min.x&&this.min.y<=t.min.y&&this.min.z<=t.min.z&&this.max.x>=t.max.x&&this.max.y>=t.max.y&&this.max.z>=t.max.z}},{key:"intersects",value:function(t){if(!this.isValid())return!1;var e=Math.abs(this.cnt.x-t.cnt.x),n=this.dim.x/2+t.dim.x/2,i=Math.abs(this.cnt.y-t.cnt.y),r=this.dim.y/2+t.dim.y/2,o=Math.abs(this.cnt.z-t.cnt.z),s=this.dim.z/2+t.dim.z/2;return e<=n&&i<=r&&o<=s}},{key:"containsPoint",value:function(t){return this.min.x<=t.x&&this.max.x>=t.x&&this.min.y<=t.y&&this.max.y>=t.y&&this.min.z<=t.z&&this.max.z>=t.z}},{key:"ext",value:function(t,e,n){return this.set(this.min.set(Math.min(this.min.x,t),Math.min(this.min.y,e),Math.min(this.min.z,n)),this.max.set(Math.max(this.max.x,t),Math.max(this.max.y,e),Math.max(this.max.z,n)))}}]),t}();e.BoundingBox=a,a.tmpVector=new s.Vector3},814:function(t,e,n){"use strict";var i=n(6690).default,r=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.OrthoCamera=void 0;var o=n(5474),s=n(2668),a=function(){function t(e,n,r,a){i(this,t),this.position=new s.Vector3(0,0,0),this.direction=new s.Vector3(0,0,-1),this.up=new s.Vector3(0,1,0),this.near=0,this.far=100,this.zoom=1,this.viewportWidth=0,this.viewportHeight=0,this.projectionView=new o.Matrix4,this.inverseProjectionView=new o.Matrix4,this.projection=new o.Matrix4,this.view=new o.Matrix4,this.tmp3=new s.Vector3,this.resize(e,n,r,a)}return r(t,[{key:"setYDown",value:function(t){t?(this.up.set(0,-1,0),this.direction.set(0,0,1)):(this.up.set(0,1,0),this.direction.set(0,0,-1)),this.update()}},{key:"resize",value:function(t,e,n,i){this.viewportWidth=t,this.viewportHeight=e,this.screenWidth=n,this.screenHeight=i,this.update()}},{key:"setPosition",value:function(t,e){this.position.set(t,e,this.position.z)}},{key:"update",value:function(){var t=this.projection,e=this.view,n=this.projectionView,i=this.inverseProjectionView,r=this.zoom,o=this.viewportWidth,s=this.viewportHeight;t.ortho(r*(-o/2),r*(o/2),r*(-s/2),r*(s/2),this.near,this.far),e.lookAt(this.position,this.direction,this.up),n.set(t.values),n.multiply(e),i.set(n.values).invert(),this.combined=n.values}},{key:"screenToWorld",value:function(t,e,n){e=e||this.screenWidth,n=n||this.screenHeight;var i=t.x,r=n-t.y-1;return t.x=2*i/e-1,t.y=2*r/n-1,t.z=2*t.z-1,t.project(this.inverseProjectionView),t}},{key:"worldToScreen",value:function(t,e,n){return e=e||this.screenWidth,n=n||this.screenHeight,t.project(this.projectionView),t.x=e*(t.x+1)/2,t.y=n*(t.y+1)/2,t.z=(t.z+1)/2,t}},{key:"unprojectVector2",value:function(t,e){this.tmp3.set(e.x,e.y,0),this.screenToWorld(this.tmp3),t.set(this.tmp3.x,this.tmp3.y)}},{key:"setViewport",value:function(t,e){this.viewportWidth=t,this.viewportHeight=e}}]),t}();e.OrthoCamera=a},2229:function(t,e,n){"use strict";var i=n(6690).default,r=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0;var o=function(){function t(){i(this,t)}return r(t,[{key:"setScreen",value:function(t){this.currentScreen&&this.currentScreen.dispose&&this.currentScreen.dispose(),this.currentScreen=t,this.currentScreen&&this.currentScreen.init&&this.currentScreen.init(this)}},{key:"update",value:function(t){this.currentScreen&&this.currentScreen.update&&this.currentScreen.update(t,this)}}]),t}();e.Game=o,o.shared=new o},5508:function(t,e,n){"use strict";var i=n(6690).default,r=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Glyph=e.PAGES=e.PAGE_SIZE=e.LOG2_PAGE_SIZE=void 0,e.LOG2_PAGE_SIZE=9,e.PAGE_SIZE=1<<e.LOG2_PAGE_SIZE,e.PAGES=65536/e.PAGE_SIZE;var o=function(){function t(){i(this,t),this.page=0}return r(t,[{key:"getKerning",value:function(t){if(this.kerning){var n=this.kerning[t.charCodeAt(0)>>>e.LOG2_PAGE_SIZE];if(null!=n)return n[t.charCodeAt(0)&e.PAGE_SIZE-1]}return 0}},{key:"setKerning",value:function(t,n){this.kerning||(this.kerning=[]);var i=this.kerning[t>>>e.LOG2_PAGE_SIZE];i||(this.kerning[t>>>e.LOG2_PAGE_SIZE]=i=new Uint32Array(new ArrayBuffer(e.PAGE_SIZE))),i[t&e.PAGE_SIZE-1]=n}}]),t}();e.Glyph=o},417:function(t,e,n){"use strict";var i=n(861).default,r=n(6690).default,o=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.GlyphLayout=void 0;var s=n(1013),a=n(8637),h=function(){function t(e,n,o,h,u,l,c,f,v){var d=this;r(this,t),this.epsilon=1e-4,this.glyphRunPool=a.Pools.get("GlyphRun",(function(){return new s.GlyphRun})),this.colorStack=new Array(4),this.runs=[],this.colors=[],this.setText=function(t,e,n,i,r,o,s,a,h){d.reset();var u=t.data;if(n!==i){a&&(o=Math.max(o,3*u.spaceXadvance));var l=a||null!=h,c=r.toIntBits(),f=c;d.colors.shift();var v=u.markupEnabled;v&&d.colorStack.push(c);for(var p=!1,y=0,M=u.down,g=null,x=null,m=n;;){var w=void 0,k=!1;if(n===i){if(m===i)break;w=i,p=!0}else{if("\n"!==e.charAt(n++))continue;w=n-1,k=!0}t:{var b=d.glyphRunPool.obtain();if(b.x=0,b.y=y,u.getGlyphs(b,e,m,w,x),d.glyphCount+=b.glyphs.length,f!==c&&(d.colors[d.colors.length-2]===d.glyphCount?d.colors[d.colors.length-1]=f:(d.colors.push(d.glyphCount),d.colors.push(f)),c=f),0===b.glyphs.length){if(d.glyphRunPool.free(b),!g)break}else g?(g.appendRun(b),d.glyphRunPool.free(b)):(g=b,d.runs.push(g));if(k||p?(d.setLastGlyphXAdvance(u,g),x=null):x=g.glyphs[g.glyphs.length-1],l&&0!==g.glyphs.length&&(k||p))for(var _=g.xAdvances[0]+g.xAdvances[1],T=2;T<g.xAdvances.length;T++){var E=g.glyphs[T-1];if(_+d.getGlyphWidth(E,u)-d.epsilon<=o)_+=g.xAdvances[T];else{if(null!=h){d.truncate(u,g,o,h);break}var A=u.getWrapIndex(g.glyphs,T);if((0===A&&0===g.x||A>=g.glyphs.length)&&(A=T-1),!(g=d.wrap(u,g,A)))break t;d.runs.push(g),y+=M,g.x=0,g.y=y,_=g.xAdvances[0]+g.xAdvances[1],T=1}}}k&&(g=null,x=null,y+=w===m?M*u.blankLineScale:M),m=n}d.height=u.capHeight+Math.abs(y),d.calculateWidths(u),d.alignRuns(o,s),v&&(d.colorStack.length=0)}else d.height=u.capHeight},this.calculateWidths=function(t){for(var e,n=0,r=i(d.runs),o=0,s=d.runs.length;o<s;o++){for(var a=r[o],h=a.xAdvances,u=a.x+h[0],l=0,c=a.glyphs,f=0;f<a.glyphs.length;){var v=c[f],p=d.getGlyphWidth(v,t);l=Math.max(l,u+p),u+=null!==(e=h[++f])&&void 0!==e?e:0}a.width=Math.max(u,l)-a.x,n=Math.max(n,a.x+(isNaN(a.width)?u:a.width))}d.width=n},this.alignRuns=function(t,e){if(0===(e&a.Align.left))for(var n=0!==(e&a.Align.center),r=i(d.runs),o=0,s=d.runs.length;o<s;o++){var h=r[o];h.x+=n?.5*(t-h.width):t-h.width}},this.truncate=function(t,e,n,i){var r=e.glyphs.length,o=d.glyphRunPool.obtain();t.getGlyphs(o,i,0,i.length,null);var s=0;if(o.xAdvances.length>0){d.setLastGlyphXAdvance(t,o);for(var h=o.xAdvances,u=1;u<o.xAdvances.length;u++)s+=h[u]}n-=s;for(var l=0,c=e.x,f=e.xAdvances;l<e.xAdvances.length;){if((c+=f[l])>n)break;l++}if(l>1){if(l-1>=0&&e.glyphs.length>l-1)for(var v=l-1;v<e.glyphs.length;v++)e.glyphs.splice(v,1);if(l>=0&&e.xAdvances.length>l)for(var p=l;p<e.xAdvances.length;p++)e.xAdvances.splice(p,1);d.setLastGlyphXAdvance(t,e),o.xAdvances.length>0&&a.Utils.arrayCopy(o.xAdvances,1,e.xAdvances,e.xAdvances.length,o.xAdvances.length-1)}else e.glyphs.length=0,e.xAdvances.length=0,a.Utils.arrayCopy(o.xAdvances,0,e.xAdvances,e.xAdvances.length,o.xAdvances.length);var y=r-e.glyphs.length;if(y>0&&(d.glyphCount-=y,t.markupEnabled))for(;d.colors.length>2&&d.colors[d.colors.length-2]>=d.glyphCount;)d.colors.length-=2;a.Utils.arrayCopy(o.glyphs,0,e.glyphs,e.glyphs.length,o.glyphs.length),d.glyphCount+=i.length,d.glyphRunPool.free(o)},this.setLastGlyphXAdvance=function(t,e){var n=e.glyphs[e.glyphs.length-1];n.fixedWidth||(e.xAdvances[e.xAdvances.length-1]=d.getGlyphWidth(n,t))},this.getGlyphWidth=function(t,e){return(t.width+t.xoffset)*e.scaleX-e.padRight},this.getLineOffset=function(t,e){return-t[0].xoffset*e.scaleX-e.padLeft},this.reset=function(){d.glyphRunPool.freeAll(d.runs),d.runs.length=0,d.colors.length=0,d.glyphCount=0,d.width=0,d.height=0},this.setText(e,n,o,h,u,l,c,f,v)}return o(t,[{key:"wrap",value:function(t,e,n){for(var i=e.glyphs.length,r=e.glyphs,o=e.xAdvances,s=n;s>0&&t.isWhitespace(r[s-1].id);s--);for(var h,u=n;u<i&&t.isWhitespace(r[u].id);u++);if(u<i){var l=(h=this.glyphRunPool.obtain()).glyphs;a.Utils.arrayCopy(r,0,l,l.length,s),r.splice(0,u-1+1),e.glyphs=l,h.glyphs=r;var c=h.xAdvances;a.Utils.arrayCopy(o,0,c,c.length,s+1),o.splice(1,u),o[0]=this.getLineOffset(r,t),e.xAdvances=c,h.xAdvances=o;var f=e.glyphs.length,v=h.glyphs.length,d=i-f-v;if(this.glyphCount-=d,t.markupEnabled&&d>0)for(var p=this.glyphCount-v,y=this.colors.length-2;y>=2;y-=2){var M=this.colors[y];if(M<=p)break;this.colors[y]=M-d}}else{r=r.slice(0,s),o=o.slice(0,s+1);var g=u-s;if(g>0&&(this.glyphCount-=g,t.markupEnabled&&this.colors[this.colors.length-2]>this.glyphCount)){for(var x=this.colors[this.colors.length-1];this.colors[this.colors.length-2]>this.glyphCount;)this.colors.length-=2;this.colors[this.colors.length-2]=this.glyphCount,this.colors[this.colors.length-1]=x}}return 0===s?(this.glyphRunPool.free(e),this.runs.pop()):this.setLastGlyphXAdvance(t,e),h}}]),t}();e.GlyphLayout=h},1013:function(t,e,n){"use strict";var i=n(9728).default,r=n(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.GlyphRun=void 0;var o=i((function t(){var e=this;r(this,t),this.glyphs=[],this.xAdvances=[],this.appendRun=function(t){e.glyphs.concat(t.glyphs),e.xAdvances.length||e.xAdvances.length--,e.xAdvances.concat(t.xAdvances)},this.reset=function(){e.glyphs.length=0,e.xAdvances.length=0}}));e.GlyphRun=o},3233:function(t,e,n){"use strict";var i=n(6690).default,r=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.InputHandler=e.InputEvent=void 0;var o=n(7465),s=n(3192);!function(t){t.TouchStart="touchStart",t.TouchEnd="touchEnd",t.TouchMove="touchMove"}(e.InputEvent||(e.InputEvent={}));var a=function(){function t(e){var n=this;i(this,t),this.screenCoord=new s.Vector2,this.worldCoord=new s.Vector2,this.canvas=e,this.lastX=0,this.lastY=0,this.touched=!1;var r=this.emitter=new o.EventEmitter;this.mouseDownHandler=function(t){n.touched=!0,n.handleMove(t),r.emit("touchStart",n.getX(),n.getY())},this.mouseUpHandler=function(t){n.touched=!1,r.emit("touchEnd",n.getX(),n.getY())},this.mouseMoveHandler=function(t){n.handleMove(t),r.emit("touchMove",n.getX(),n.getY())},this.touchStartHandler=function(t){t.preventDefault();var e=t.touches[0];n.canvas.dispatchEvent(new MouseEvent("mousedown",{clientX:e.clientX,clientY:e.clientY}))},this.touchEndHandler=function(t){t.preventDefault(),n.canvas.dispatchEvent(new MouseEvent("mouseup"))},this.touchMoveHandler=function(t){t.preventDefault();var e=t.touches[0];n.canvas.dispatchEvent(new MouseEvent("mousemove",{clientX:e.clientX,clientY:e.clientY}))},this.canvas.addEventListener("mousedown",this.mouseDownHandler,!1),this.canvas.addEventListener("mouseup",this.mouseUpHandler,!1),this.canvas.addEventListener("mousemove",this.mouseMoveHandler,!1),this.canvas.addEventListener("touchstart",this.touchStartHandler,!1),this.canvas.addEventListener("touchend",this.touchEndHandler,!1),this.canvas.addEventListener("touchmove",this.touchMoveHandler,!1)}return r(t,[{key:"cleanup",value:function(){this.canvas.removeEventListener("mousedown",this.mouseDownHandler),this.canvas.removeEventListener("mouseup",this.mouseUpHandler),this.canvas.removeEventListener("mousemove",this.mouseMoveHandler),this.canvas.removeEventListener("touchstart",this.touchStartHandler),this.canvas.removeEventListener("touchend",this.touchEndHandler),this.canvas.removeEventListener("touchmove",this.touchMoveHandler)}},{key:"addEventListener",value:function(t,e){this.emitter.addListener(t,e)}},{key:"handleMove",value:function(t){var e=this.canvas.getBoundingClientRect(),n=t.clientX-e.left,i=t.clientY-e.top;this.lastX=n,this.lastY=i}},{key:"getX",value:function(){return this.lastX}},{key:"getY",value:function(){return this.lastY}},{key:"isTouched",value:function(){return this.touched}},{key:"getTouchedWorldCoord",value:function(t){return this.screenCoord.set(this.getX(),this.getY()),t.unprojectVector2(this.worldCoord,this.screenCoord),this.worldCoord}}]),t}();e.InputHandler=a},5474:function(t,e,n){"use strict";var i=n(6690).default,r=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Matrix4=e.M33=e.M32=e.M31=e.M30=e.M23=e.M22=e.M21=e.M20=e.M13=e.M12=e.M11=e.M10=e.M03=e.M02=e.M01=e.M00=void 0;var o=n(2668);e.M00=0,e.M01=4,e.M02=8,e.M03=12,e.M10=1,e.M11=5,e.M12=9,e.M13=13,e.M20=2,e.M21=6,e.M22=10,e.M23=14,e.M30=3,e.M31=7,e.M32=11,e.M33=15;var s=function(){function t(){i(this,t),this.temp=new Float32Array(16),this.values=new Float32Array(16);var n=this.values;n[e.M00]=1,n[e.M11]=1,n[e.M22]=1,n[e.M33]=1}return r(t,[{key:"set",value:function(t){return this.values.set(t),this}},{key:"transpose",value:function(){var t=this.temp,n=this.values;return t[e.M00]=n[e.M00],t[e.M01]=n[e.M10],t[e.M02]=n[e.M20],t[e.M03]=n[e.M30],t[e.M10]=n[e.M01],t[e.M11]=n[e.M11],t[e.M12]=n[e.M21],t[e.M13]=n[e.M31],t[e.M20]=n[e.M02],t[e.M21]=n[e.M12],t[e.M22]=n[e.M22],t[e.M23]=n[e.M32],t[e.M30]=n[e.M03],t[e.M31]=n[e.M13],t[e.M32]=n[e.M23],t[e.M33]=n[e.M33],this.set(t)}},{key:"identity",value:function(){var t=this.values;return t[e.M00]=1,t[e.M01]=0,t[e.M02]=0,t[e.M03]=0,t[e.M10]=0,t[e.M11]=1,t[e.M12]=0,t[e.M13]=0,t[e.M20]=0,t[e.M21]=0,t[e.M22]=1,t[e.M23]=0,t[e.M30]=0,t[e.M31]=0,t[e.M32]=0,t[e.M33]=1,this}},{key:"invert",value:function(){var t=this.values,n=this.temp,i=t[e.M30]*t[e.M21]*t[e.M12]*t[e.M03]-t[e.M20]*t[e.M31]*t[e.M12]*t[e.M03]-t[e.M30]*t[e.M11]*t[e.M22]*t[e.M03]+t[e.M10]*t[e.M31]*t[e.M22]*t[e.M03]+t[e.M20]*t[e.M11]*t[e.M32]*t[e.M03]-t[e.M10]*t[e.M21]*t[e.M32]*t[e.M03]-t[e.M30]*t[e.M21]*t[e.M02]*t[e.M13]+t[e.M20]*t[e.M31]*t[e.M02]*t[e.M13]+t[e.M30]*t[e.M01]*t[e.M22]*t[e.M13]-t[e.M00]*t[e.M31]*t[e.M22]*t[e.M13]-t[e.M20]*t[e.M01]*t[e.M32]*t[e.M13]+t[e.M00]*t[e.M21]*t[e.M32]*t[e.M13]+t[e.M30]*t[e.M11]*t[e.M02]*t[e.M23]-t[e.M10]*t[e.M31]*t[e.M02]*t[e.M23]-t[e.M30]*t[e.M01]*t[e.M12]*t[e.M23]+t[e.M00]*t[e.M31]*t[e.M12]*t[e.M23]+t[e.M10]*t[e.M01]*t[e.M32]*t[e.M23]-t[e.M00]*t[e.M11]*t[e.M32]*t[e.M23]-t[e.M20]*t[e.M11]*t[e.M02]*t[e.M33]+t[e.M10]*t[e.M21]*t[e.M02]*t[e.M33]+t[e.M20]*t[e.M01]*t[e.M12]*t[e.M33]-t[e.M00]*t[e.M21]*t[e.M12]*t[e.M33]-t[e.M10]*t[e.M01]*t[e.M22]*t[e.M33]+t[e.M00]*t[e.M11]*t[e.M22]*t[e.M33];if(0===i)throw new Error("non-invertible matrix");var r=1/i;return n[e.M00]=t[e.M12]*t[e.M23]*t[e.M31]-t[e.M13]*t[e.M22]*t[e.M31]+t[e.M13]*t[e.M21]*t[e.M32]-t[e.M11]*t[e.M23]*t[e.M32]-t[e.M12]*t[e.M21]*t[e.M33]+t[e.M11]*t[e.M22]*t[e.M33],n[e.M01]=t[e.M03]*t[e.M22]*t[e.M31]-t[e.M02]*t[e.M23]*t[e.M31]-t[e.M03]*t[e.M21]*t[e.M32]+t[e.M01]*t[e.M23]*t[e.M32]+t[e.M02]*t[e.M21]*t[e.M33]-t[e.M01]*t[e.M22]*t[e.M33],n[e.M02]=t[e.M02]*t[e.M13]*t[e.M31]-t[e.M03]*t[e.M12]*t[e.M31]+t[e.M03]*t[e.M11]*t[e.M32]-t[e.M01]*t[e.M13]*t[e.M32]-t[e.M02]*t[e.M11]*t[e.M33]+t[e.M01]*t[e.M12]*t[e.M33],n[e.M03]=t[e.M03]*t[e.M12]*t[e.M21]-t[e.M02]*t[e.M13]*t[e.M21]-t[e.M03]*t[e.M11]*t[e.M22]+t[e.M01]*t[e.M13]*t[e.M22]+t[e.M02]*t[e.M11]*t[e.M23]-t[e.M01]*t[e.M12]*t[e.M23],n[e.M10]=t[e.M13]*t[e.M22]*t[e.M30]-t[e.M12]*t[e.M23]*t[e.M30]-t[e.M13]*t[e.M20]*t[e.M32]+t[e.M10]*t[e.M23]*t[e.M32]+t[e.M12]*t[e.M20]*t[e.M33]-t[e.M10]*t[e.M22]*t[e.M33],n[e.M11]=t[e.M02]*t[e.M23]*t[e.M30]-t[e.M03]*t[e.M22]*t[e.M30]+t[e.M03]*t[e.M20]*t[e.M32]-t[e.M00]*t[e.M23]*t[e.M32]-t[e.M02]*t[e.M20]*t[e.M33]+t[e.M00]*t[e.M22]*t[e.M33],n[e.M12]=t[e.M03]*t[e.M12]*t[e.M30]-t[e.M02]*t[e.M13]*t[e.M30]-t[e.M03]*t[e.M10]*t[e.M32]+t[e.M00]*t[e.M13]*t[e.M32]+t[e.M02]*t[e.M10]*t[e.M33]-t[e.M00]*t[e.M12]*t[e.M33],n[e.M13]=t[e.M02]*t[e.M13]*t[e.M20]-t[e.M03]*t[e.M12]*t[e.M20]+t[e.M03]*t[e.M10]*t[e.M22]-t[e.M00]*t[e.M13]*t[e.M22]-t[e.M02]*t[e.M10]*t[e.M23]+t[e.M00]*t[e.M12]*t[e.M23],n[e.M20]=t[e.M11]*t[e.M23]*t[e.M30]-t[e.M13]*t[e.M21]*t[e.M30]+t[e.M13]*t[e.M20]*t[e.M31]-t[e.M10]*t[e.M23]*t[e.M31]-t[e.M11]*t[e.M20]*t[e.M33]+t[e.M10]*t[e.M21]*t[e.M33],n[e.M21]=t[e.M03]*t[e.M21]*t[e.M30]-t[e.M01]*t[e.M23]*t[e.M30]-t[e.M03]*t[e.M20]*t[e.M31]+t[e.M00]*t[e.M23]*t[e.M31]+t[e.M01]*t[e.M20]*t[e.M33]-t[e.M00]*t[e.M21]*t[e.M33],n[e.M22]=t[e.M01]*t[e.M13]*t[e.M30]-t[e.M03]*t[e.M11]*t[e.M30]+t[e.M03]*t[e.M10]*t[e.M31]-t[e.M00]*t[e.M13]*t[e.M31]-t[e.M01]*t[e.M10]*t[e.M33]+t[e.M00]*t[e.M11]*t[e.M33],n[e.M23]=t[e.M03]*t[e.M11]*t[e.M20]-t[e.M01]*t[e.M13]*t[e.M20]-t[e.M03]*t[e.M10]*t[e.M21]+t[e.M00]*t[e.M13]*t[e.M21]+t[e.M01]*t[e.M10]*t[e.M23]-t[e.M00]*t[e.M11]*t[e.M23],n[e.M30]=t[e.M12]*t[e.M21]*t[e.M30]-t[e.M11]*t[e.M22]*t[e.M30]-t[e.M12]*t[e.M20]*t[e.M31]+t[e.M10]*t[e.M22]*t[e.M31]+t[e.M11]*t[e.M20]*t[e.M32]-t[e.M10]*t[e.M21]*t[e.M32],n[e.M31]=t[e.M01]*t[e.M22]*t[e.M30]-t[e.M02]*t[e.M21]*t[e.M30]+t[e.M02]*t[e.M20]*t[e.M31]-t[e.M00]*t[e.M22]*t[e.M31]-t[e.M01]*t[e.M20]*t[e.M32]+t[e.M00]*t[e.M21]*t[e.M32],n[e.M32]=t[e.M02]*t[e.M11]*t[e.M30]-t[e.M01]*t[e.M12]*t[e.M30]-t[e.M02]*t[e.M10]*t[e.M31]+t[e.M00]*t[e.M12]*t[e.M31]+t[e.M01]*t[e.M10]*t[e.M32]-t[e.M00]*t[e.M11]*t[e.M32],n[e.M33]=t[e.M01]*t[e.M12]*t[e.M20]-t[e.M02]*t[e.M11]*t[e.M20]+t[e.M02]*t[e.M10]*t[e.M21]-t[e.M00]*t[e.M12]*t[e.M21]-t[e.M01]*t[e.M10]*t[e.M22]+t[e.M00]*t[e.M11]*t[e.M22],t[e.M00]=n[e.M00]*r,t[e.M01]=n[e.M01]*r,t[e.M02]=n[e.M02]*r,t[e.M03]=n[e.M03]*r,t[e.M10]=n[e.M10]*r,t[e.M11]=n[e.M11]*r,t[e.M12]=n[e.M12]*r,t[e.M13]=n[e.M13]*r,t[e.M20]=n[e.M20]*r,t[e.M21]=n[e.M21]*r,t[e.M22]=n[e.M22]*r,t[e.M23]=n[e.M23]*r,t[e.M30]=n[e.M30]*r,t[e.M31]=n[e.M31]*r,t[e.M32]=n[e.M32]*r,t[e.M33]=n[e.M33]*r,this}},{key:"determinant",value:function(){var t=this.values;return t[e.M30]*t[e.M21]*t[e.M12]*t[e.M03]-t[e.M20]*t[e.M31]*t[e.M12]*t[e.M03]-t[e.M30]*t[e.M11]*t[e.M22]*t[e.M03]+t[e.M10]*t[e.M31]*t[e.M22]*t[e.M03]+t[e.M20]*t[e.M11]*t[e.M32]*t[e.M03]-t[e.M10]*t[e.M21]*t[e.M32]*t[e.M03]-t[e.M30]*t[e.M21]*t[e.M02]*t[e.M13]+t[e.M20]*t[e.M31]*t[e.M02]*t[e.M13]+t[e.M30]*t[e.M01]*t[e.M22]*t[e.M13]-t[e.M00]*t[e.M31]*t[e.M22]*t[e.M13]-t[e.M20]*t[e.M01]*t[e.M32]*t[e.M13]+t[e.M00]*t[e.M21]*t[e.M32]*t[e.M13]+t[e.M30]*t[e.M11]*t[e.M02]*t[e.M23]-t[e.M10]*t[e.M31]*t[e.M02]*t[e.M23]-t[e.M30]*t[e.M01]*t[e.M12]*t[e.M23]+t[e.M00]*t[e.M31]*t[e.M12]*t[e.M23]+t[e.M10]*t[e.M01]*t[e.M32]*t[e.M23]-t[e.M00]*t[e.M11]*t[e.M32]*t[e.M23]-t[e.M20]*t[e.M11]*t[e.M02]*t[e.M33]+t[e.M10]*t[e.M21]*t[e.M02]*t[e.M33]+t[e.M20]*t[e.M01]*t[e.M12]*t[e.M33]-t[e.M00]*t[e.M21]*t[e.M12]*t[e.M33]-t[e.M10]*t[e.M01]*t[e.M22]*t[e.M33]+t[e.M00]*t[e.M11]*t[e.M22]*t[e.M33]}},{key:"translate",value:function(t,n,i){var r=this.values;return r[e.M03]+=t,r[e.M13]+=n,r[e.M23]+=i,this}},{key:"copy",value:function(){return(new t).set(this.values)}},{key:"projection",value:function(t,n,i,r){this.identity();var o=1/Math.tan(i*(Math.PI/180)/2),s=(n+t)/(t-n),a=2*n*t/(t-n),h=this.values;return h[e.M00]=o/r,h[e.M10]=0,h[e.M20]=0,h[e.M30]=0,h[e.M01]=0,h[e.M11]=o,h[e.M21]=0,h[e.M31]=0,h[e.M02]=0,h[e.M12]=0,h[e.M22]=s,h[e.M32]=-1,h[e.M03]=0,h[e.M13]=0,h[e.M23]=a,h[e.M33]=0,this}},{key:"ortho2d",value:function(t,e,n,i){return this.ortho(t,t+n,e,e+i,0,1)}},{key:"ortho",value:function(t,n,i,r,o,s){this.identity();var a=2/(n-t),h=2/(r-i),u=-2/(s-o),l=-(n+t)/(n-t),c=-(r+i)/(r-i),f=-(s+o)/(s-o),v=this.values;return v[e.M00]=a,v[e.M10]=0,v[e.M20]=0,v[e.M30]=0,v[e.M01]=0,v[e.M11]=h,v[e.M21]=0,v[e.M31]=0,v[e.M02]=0,v[e.M12]=0,v[e.M22]=u,v[e.M32]=0,v[e.M03]=l,v[e.M13]=c,v[e.M23]=f,v[e.M33]=1,this}},{key:"multiply",value:function(t){var n=this.temp,i=this.values,r=t.values;return n[e.M00]=i[e.M00]*r[e.M00]+i[e.M01]*r[e.M10]+i[e.M02]*r[e.M20]+i[e.M03]*r[e.M30],n[e.M01]=i[e.M00]*r[e.M01]+i[e.M01]*r[e.M11]+i[e.M02]*r[e.M21]+i[e.M03]*r[e.M31],n[e.M02]=i[e.M00]*r[e.M02]+i[e.M01]*r[e.M12]+i[e.M02]*r[e.M22]+i[e.M03]*r[e.M32],n[e.M03]=i[e.M00]*r[e.M03]+i[e.M01]*r[e.M13]+i[e.M02]*r[e.M23]+i[e.M03]*r[e.M33],n[e.M10]=i[e.M10]*r[e.M00]+i[e.M11]*r[e.M10]+i[e.M12]*r[e.M20]+i[e.M13]*r[e.M30],n[e.M11]=i[e.M10]*r[e.M01]+i[e.M11]*r[e.M11]+i[e.M12]*r[e.M21]+i[e.M13]*r[e.M31],n[e.M12]=i[e.M10]*r[e.M02]+i[e.M11]*r[e.M12]+i[e.M12]*r[e.M22]+i[e.M13]*r[e.M32],n[e.M13]=i[e.M10]*r[e.M03]+i[e.M11]*r[e.M13]+i[e.M12]*r[e.M23]+i[e.M13]*r[e.M33],n[e.M20]=i[e.M20]*r[e.M00]+i[e.M21]*r[e.M10]+i[e.M22]*r[e.M20]+i[e.M23]*r[e.M30],n[e.M21]=i[e.M20]*r[e.M01]+i[e.M21]*r[e.M11]+i[e.M22]*r[e.M21]+i[e.M23]*r[e.M31],n[e.M22]=i[e.M20]*r[e.M02]+i[e.M21]*r[e.M12]+i[e.M22]*r[e.M22]+i[e.M23]*r[e.M32],n[e.M23]=i[e.M20]*r[e.M03]+i[e.M21]*r[e.M13]+i[e.M22]*r[e.M23]+i[e.M23]*r[e.M33],n[e.M30]=i[e.M30]*r[e.M00]+i[e.M31]*r[e.M10]+i[e.M32]*r[e.M20]+i[e.M33]*r[e.M30],n[e.M31]=i[e.M30]*r[e.M01]+i[e.M31]*r[e.M11]+i[e.M32]*r[e.M21]+i[e.M33]*r[e.M31],n[e.M32]=i[e.M30]*r[e.M02]+i[e.M31]*r[e.M12]+i[e.M32]*r[e.M22]+i[e.M33]*r[e.M32],n[e.M33]=i[e.M30]*r[e.M03]+i[e.M31]*r[e.M13]+i[e.M32]*r[e.M23]+i[e.M33]*r[e.M33],this.set(this.temp)}},{key:"multiplyLeft",value:function(t){var n=this.temp,i=this.values,r=t.values;return n[e.M00]=r[e.M00]*i[e.M00]+r[e.M01]*i[e.M10]+r[e.M02]*i[e.M20]+r[e.M03]*i[e.M30],n[e.M01]=r[e.M00]*i[e.M01]+r[e.M01]*i[e.M11]+r[e.M02]*i[e.M21]+r[e.M03]*i[e.M31],n[e.M02]=r[e.M00]*i[e.M02]+r[e.M01]*i[e.M12]+r[e.M02]*i[e.M22]+r[e.M03]*i[e.M32],n[e.M03]=r[e.M00]*i[e.M03]+r[e.M01]*i[e.M13]+r[e.M02]*i[e.M23]+r[e.M03]*i[e.M33],n[e.M10]=r[e.M10]*i[e.M00]+r[e.M11]*i[e.M10]+r[e.M12]*i[e.M20]+r[e.M13]*i[e.M30],n[e.M11]=r[e.M10]*i[e.M01]+r[e.M11]*i[e.M11]+r[e.M12]*i[e.M21]+r[e.M13]*i[e.M31],n[e.M12]=r[e.M10]*i[e.M02]+r[e.M11]*i[e.M12]+r[e.M12]*i[e.M22]+r[e.M13]*i[e.M32],n[e.M13]=r[e.M10]*i[e.M03]+r[e.M11]*i[e.M13]+r[e.M12]*i[e.M23]+r[e.M13]*i[e.M33],n[e.M20]=r[e.M20]*i[e.M00]+r[e.M21]*i[e.M10]+r[e.M22]*i[e.M20]+r[e.M23]*i[e.M30],n[e.M21]=r[e.M20]*i[e.M01]+r[e.M21]*i[e.M11]+r[e.M22]*i[e.M21]+r[e.M23]*i[e.M31],n[e.M22]=r[e.M20]*i[e.M02]+r[e.M21]*i[e.M12]+r[e.M22]*i[e.M22]+r[e.M23]*i[e.M32],n[e.M23]=r[e.M20]*i[e.M03]+r[e.M21]*i[e.M13]+r[e.M22]*i[e.M23]+r[e.M23]*i[e.M33],n[e.M30]=r[e.M30]*i[e.M00]+r[e.M31]*i[e.M10]+r[e.M32]*i[e.M20]+r[e.M33]*i[e.M30],n[e.M31]=r[e.M30]*i[e.M01]+r[e.M31]*i[e.M11]+r[e.M32]*i[e.M21]+r[e.M33]*i[e.M31],n[e.M32]=r[e.M30]*i[e.M02]+r[e.M31]*i[e.M12]+r[e.M32]*i[e.M22]+r[e.M33]*i[e.M32],n[e.M33]=r[e.M30]*i[e.M03]+r[e.M31]*i[e.M13]+r[e.M32]*i[e.M23]+r[e.M33]*i[e.M33],this.set(this.temp)}},{key:"lookAt",value:function(n,i,r){t.initTemps();var o=t.xAxis,s=t.yAxis,a=t.zAxis;a.setFrom(i).normalize(),o.setFrom(i).normalize(),o.cross(r).normalize(),s.setFrom(o).cross(a).normalize(),this.identity();var h=this.values;return h[e.M00]=o.x,h[e.M01]=o.y,h[e.M02]=o.z,h[e.M10]=s.x,h[e.M11]=s.y,h[e.M12]=s.z,h[e.M20]=-a.x,h[e.M21]=-a.y,h[e.M22]=-a.z,t.tmpMatrix.identity(),t.tmpMatrix.values[e.M03]=-n.x,t.tmpMatrix.values[e.M13]=-n.y,t.tmpMatrix.values[e.M23]=-n.z,this.multiply(t.tmpMatrix),this}}],[{key:"initTemps",value:function(){null===t.xAxis&&(t.xAxis=new o.Vector3),null===t.yAxis&&(t.yAxis=new o.Vector3),null===t.zAxis&&(t.zAxis=new o.Vector3)}}]),t}();e.Matrix4=s,s.xAxis=null,s.yAxis=null,s.zAxis=null,s.tmpMatrix=new s},4731:function(t,e,n){"use strict";var i=n(1655).default,r=n(6389).default,o=n(6690).default,s=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Color2Attribute=e.ColorAttribute=e.TexCoordAttribute=e.Position3Attribute=e.Position2Attribute=e.VertexAttribute=e.VertexAttributeType=e.Mesh=void 0;var a,h=n(6403),u=function(){function t(e,n,i,r){o(this,t),this.attributes=n,this.verticesLength=0,this.dirtyVertices=!1,this.indicesLength=0,this.dirtyIndices=!1,this.elementsPerVertex=0,this.context=e,this.elementsPerVertex=0;for(var s=0;s<n.length;s++)this.elementsPerVertex+=n[s].numElements;this.vertices=new Float32Array(i*this.elementsPerVertex),this.indices=new Uint16Array(r)}return s(t,[{key:"getAttributes",value:function(){return this.attributes}},{key:"maxVertices",value:function(){return this.vertices.length/this.elementsPerVertex}},{key:"numVertices",value:function(){return this.verticesLength/this.elementsPerVertex}},{key:"setVerticesLength",value:function(t){this.dirtyVertices=!0,this.verticesLength=t}},{key:"getVertices",value:function(){return this.vertices}},{key:"maxIndices",value:function(){return this.indices.length}},{key:"numIndices",value:function(){return this.indicesLength}},{key:"setIndicesLength",value:function(t){this.dirtyIndices=!0,this.indicesLength=t}},{key:"getIndices",value:function(){return this.indices}},{key:"getVertexSizeInFloats",value:function(){for(var t=0,e=0;e<this.attributes.length;e++){t+=this.attributes[e].numElements}return t}},{key:"setVertices",value:function(t){if(this.dirtyVertices=!0,t.length>this.vertices.length)throw Error("Mesh can't store more than "+this.maxVertices()+" vertices");this.vertices.set(t,0),this.verticesLength=t.length}},{key:"setIndices",value:function(t){if(this.dirtyIndices=!0,t.length>this.indices.length)throw Error("Mesh can't store more than "+this.maxIndices()+" indices");this.indices.set(t,0),this.indicesLength=t.length}},{key:"draw",value:function(t,e){this.drawWithOffset(t,e,0,this.indicesLength>0?this.indicesLength:this.verticesLength/this.elementsPerVertex)}},{key:"drawWithOffset",value:function(t,e,n,i){var r=this.context;(this.dirtyVertices||this.dirtyIndices)&&this.update(),this.bind(t),this.indicesLength>0?r.drawElements(e,i,r.UNSIGNED_SHORT,2*n):r.drawArrays(e,n,i),this.unbind(t)}},{key:"bind",value:function(t){var e=this.context;e.bindBuffer(e.ARRAY_BUFFER,this.verticesBuffer);for(var n=0,i=0;i<this.attributes.length;i++){var r=this.attributes[i],o=t.getAttributeLocation(r.name);e.enableVertexAttribArray(o),e.vertexAttribPointer(o,r.numElements,e.FLOAT,!1,4*this.elementsPerVertex,4*n),n+=r.numElements}this.indicesLength>0&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)}},{key:"unbind",value:function(t){for(var e=this.context,n=0;n<this.attributes.length;n++){var i=this.attributes[n],r=t.getAttributeLocation(i.name);e.disableVertexAttribArray(r)}e.bindBuffer(e.ARRAY_BUFFER,null),this.indicesLength>0&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}},{key:"update",value:function(){var t=this.context;this.dirtyVertices&&(this.verticesBuffer||(this.verticesBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.verticesBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices.subarray(0,this.verticesLength),t.DYNAMIC_DRAW),this.dirtyVertices=!1),this.dirtyIndices&&(this.indicesBuffer||(this.indicesBuffer=t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices.subarray(0,this.indicesLength),t.DYNAMIC_DRAW),this.dirtyIndices=!1)}},{key:"restore",value:function(){this.verticesBuffer=null,this.indicesBuffer=null,this.update()}},{key:"dispose",value:function(){var t=this.context;t.deleteBuffer(this.verticesBuffer),t.deleteBuffer(this.indicesBuffer)}}]),t}();e.Mesh=u,function(t){t[t.Float=0]="Float"}(a=e.VertexAttributeType||(e.VertexAttributeType={}));var l=s((function t(e,n,i){o(this,t),this.name=e,this.type=n,this.numElements=i}));e.VertexAttribute=l;var c=function(t){i(n,t);var e=r(n);function n(){return o(this,n),e.call(this,h.Shader.POSITION,a.Float,2)}return s(n)}(l);e.Position2Attribute=c;var f=function(t){i(n,t);var e=r(n);function n(){return o(this,n),e.call(this,h.Shader.POSITION,a.Float,3)}return s(n)}(l);e.Position3Attribute=f;var v=function(t){i(n,t);var e=r(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return o(this,n),e.call(this,h.Shader.TEXCOORDS+(0===t?"":t),a.Float,2)}return s(n)}(l);e.TexCoordAttribute=v;var d=function(t){i(n,t);var e=r(n);function n(){return o(this,n),e.call(this,h.Shader.COLOR,a.Float,4)}return s(n)}(l);e.ColorAttribute=d;var p=function(t){i(n,t);var e=r(n);function n(){return o(this,n),e.call(this,h.Shader.COLOR2,a.Float,4)}return s(n)}(l);e.Color2Attribute=p},2226:function(t,e,n){"use strict";var i=n(6690).default,r=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.NumberUtil=void 0;var o=new Int8Array(4),s=new Int32Array(o.buffer,0,1),a=new Float32Array(o.buffer,0,1),h=function(){function t(){i(this,t)}return r(t,null,[{key:"intBitsToFloat",value:function(t){return s[0]=t,a[0]}},{key:"floatToIntBits",value:function(t){return a[0]=t,s[0]}},{key:"intToFloatColor",value:function(e){return t.intBitsToFloat(4278190079&e)}},{key:"colorToFloat",value:function(e,n,i,r){var o=e<<24|n<<16|i<<8|r;return t.intToFloatColor(o)}},{key:"isPowerOfTwo",value:function(t){return 0===(t&t-1)}},{key:"nextPowerOfTwo",value:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1}}]),t}();e.NumberUtil=h},2991:function(t,e,n){"use strict";var i=n(6690).default,r=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.PolygonBatch=void 0;var o=n(8637),s=n(4731),a=n(6403),h=[0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0],u=new o.Color(1,1,1,1),l=function(){function t(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10920;if(i(this,t),this.isDrawing=!1,this.shader=null,this.lastTexture=null,this.verticesLength=0,this.indicesLength=0,this.projectionValues=new Float32Array(16),this.color=u,this.twoColorTint=!0,this.yDown=!1,r>10920)throw new Error("Can't have more than 10920 triangles per batch: "+r);this.context=e;var o=n?[new s.Position2Attribute,new s.ColorAttribute,new s.TexCoordAttribute,new s.Color2Attribute]:[new s.Position2Attribute,new s.ColorAttribute,new s.TexCoordAttribute];this.mesh=new s.Mesh(e,o,r,3*r),this.shader=a.Shader.newTwoColoredTextured(e);var h=this.context;this.srcColorBlend=h.SRC_ALPHA,this.srcAlphaBlend=h.ONE,this.dstBlend=h.ONE_MINUS_SRC_ALPHA,this.twoColorTint=n}return r(t,[{key:"setColor",value:function(t){this.color=t}},{key:"setShader",value:function(t){this.shader.dispose(),this.shader=t}},{key:"setProjection",value:function(t){this.projectionValues=t}},{key:"begin",value:function(){if(this.isDrawing)throw new Error("PolygonBatch is already drawing. Call PolygonBatch.end() before calling PolygonBatch.begin()");this.drawCalls=0;var t=this.shader;this.lastTexture=null,this.isDrawing=!0,t.bind(),t.setUniform4x4f(a.Shader.MVP_MATRIX,this.projectionValues),t.setUniformi("u_texture",0);var e=this.context;e.enable(e.BLEND),e.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)}},{key:"setBlendMode",value:function(t,e,n){this.srcColorBlend===t&&this.srcAlphaBlend===e&&this.dstBlend===n||(this.srcColorBlend=t,this.srcAlphaBlend=e,this.dstBlend=n,this.isDrawing&&(this.flush(),this.context.blendFuncSeparate(t,n,e,n)))}},{key:"drawVerticesWithOffset",value:function(e,n,i,r){for(var o=[],s=0;s<r;s++)o[s]=n[s+i];this.drawVertices(e,o,t.QUAD_TRIANGLES)}},{key:"drawVertices",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.QUAD_TRIANGLES;e!==this.lastTexture?(this.flush(),this.lastTexture=e):(this.verticesLength+n.length>this.mesh.getVertices().length||this.indicesLength+i.length>this.mesh.getIndices().length)&&this.flush();var r=this.mesh.numVertices();this.mesh.getVertices().set(n,this.verticesLength),this.verticesLength+=n.length,this.mesh.setVerticesLength(this.verticesLength);for(var o=this.mesh.getIndices(),s=this.indicesLength,a=0;a<i.length;s++,a++)o[s]=i[a]+r;this.indicesLength+=i.length,this.mesh.setIndicesLength(this.indicesLength)}},{key:"flush",value:function(){0!==this.verticesLength&&(this.lastTexture.bind(),this.mesh.draw(this.shader,this.context.TRIANGLES),this.verticesLength=0,this.indicesLength=0,this.mesh.setVerticesLength(0),this.mesh.setIndicesLength(0),this.drawCalls++)}},{key:"end",value:function(){if(!this.isDrawing)throw new Error("PolygonBatch is not drawing. Call PolygonBatch.begin() before calling PolygonBatch.end()");(this.verticesLength>0||this.indicesLength>0)&&this.flush(),this.shader.unbind(),this.lastTexture=null,this.isDrawing=!1,t.totalDrawCalls+=this.drawCalls;var e=this.context;e.disable(e.BLEND)}},{key:"getDrawCalls",value:function(){return this.drawCalls}},{key:"dispose",value:function(){this.mesh.dispose()}},{key:"setYDown",value:function(t){this.yDown=t}},{key:"draw",value:function(e,n,i,r,o){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,v=arguments.length>11&&void 0!==arguments[11]?arguments[11]:1,d=arguments.length>12&&void 0!==arguments[12]?arguments[12]:1,p=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,y=arguments.length>14&&void 0!==arguments[14]&&arguments[14],M=this.color;if(this.yDown){var g=v;v=p,p=g}n=n||0,i=i||0;var x=-s,m=(r=0===r?r:r||e.width)-s,w=r-s,k=-s,b=-a,_=-a,T=(o=0===o?o:o||e.height)-a,E=o-a;if(1!==l&&(x*=l,m*=l,w*=l,k*=l),1!==c&&(b*=c,_*=c,T*=c,E*=c),0!==u){var A=Math.cos(u),L=Math.sin(u),P=A*x-L*b,C=L*x+A*b,S=A*m-L*_,O=L*m+A*_,R=A*w-L*T,I=L*w+A*T,V=A*k-L*E,F=L*k+A*E;x=P,m=S,w=R,k=V,b=C,_=O,T=I,E=F}x+=n+s,m+=n+s,w+=n+s,k+=n+s,b+=i+a,_+=i+a,T+=i+a,E+=i+a;var G=f,D=v,z=d,j=p,B=z,N=D,U=G,X=j;y&&(this.yDown?(G=f,D=p,z=d,j=v,B=f,N=v,U=d,X=p):(G=d,D=v,z=f,j=p,B=d,N=p,U=f,X=v));var H=0;h[H++]=x,h[H++]=b,h[H++]=M.r,h[H++]=M.g,h[H++]=M.b,h[H++]=M.a,h[H++]=G,h[H++]=D,this.twoColorTint&&(h[H++]=0,h[H++]=0,h[H++]=0,h[H++]=0),h[H++]=m,h[H++]=_,h[H++]=M.r,h[H++]=M.g,h[H++]=M.b,h[H++]=M.a,h[H++]=B,h[H++]=N,this.twoColorTint&&(h[H++]=0,h[H++]=0,h[H++]=0,h[H++]=0),h[H++]=w,h[H++]=T,h[H++]=M.r,h[H++]=M.g,h[H++]=M.b,h[H++]=M.a,h[H++]=z,h[H++]=j,this.twoColorTint&&(h[H++]=0,h[H++]=0,h[H++]=0,h[H++]=0),h[H++]=k,h[H++]=E,h[H++]=M.r,h[H++]=M.g,h[H++]=M.b,h[H++]=M.a,h[H++]=U,h[H++]=X,this.twoColorTint&&(h[H++]=0,h[H++]=0,h[H++]=0,h[H]=0),this.drawVertices(e,h,t.QUAD_TRIANGLES)}}],[{key:"resetTotalDrawCalls",value:function(){t.totalDrawCalls=0}}]),t}();e.PolygonBatch=l,l.QUAD_TRIANGLES=[0,1,2,2,3,0],l.totalDrawCalls=0},6403:function(t,e,n){"use strict";var i=n(6690).default,r=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Shader=void 0;var o=function(){function t(e,n,r){i(this,t),this.vertexShader=n,this.fragmentShader=r,this.vs=null,this.fs=null,this.program=null,this.tmp2x2=new Float32Array(4),this.tmp3x3=new Float32Array(9),this.tmp4x4=new Float32Array(16),this.vsSource=n,this.fsSource=r,this.context=e,this.compile()}return r(t,[{key:"getProgram",value:function(){return this.program}},{key:"getVertexShader",value:function(){return this.vertexShader}},{key:"getFragmentShader",value:function(){return this.fragmentShader}},{key:"getVertexShaderSource",value:function(){return this.vsSource}},{key:"getFragmentSource",value:function(){return this.fsSource}},{key:"compile",value:function(){var t=this.context;try{this.vs=this.compileShader(t.VERTEX_SHADER,this.vertexShader),this.fs=this.compileShader(t.FRAGMENT_SHADER,this.fragmentShader),this.program=this.compileProgram(this.vs,this.fs)}catch(e){throw this.dispose(),e}}},{key:"compileShader",value:function(t,e){var n=this.context,i=n.createShader(t);if(n.shaderSource(i,e),n.compileShader(i),!n.getShaderParameter(i,n.COMPILE_STATUS)){var r="Couldn't compile shader: "+n.getShaderInfoLog(i);if(n.deleteShader(i),!n.isContextLost())throw new Error(r)}return i}},{key:"compileProgram",value:function(t,e){var n=this.context,i=n.createProgram();if(n.attachShader(i,t),n.attachShader(i,e),n.linkProgram(i),!n.getProgramParameter(i,n.LINK_STATUS)){var r="Couldn't compile shader program: "+n.getProgramInfoLog(i);if(n.deleteProgram(i),!n.isContextLost())throw new Error(r)}return i}},{key:"restore",value:function(){this.compile()}},{key:"bind",value:function(){this.context.useProgram(this.program)}},{key:"unbind",value:function(){this.context.useProgram(null)}},{key:"setUniformi",value:function(t,e){this.context.uniform1i(this.getUniformLocation(t),e)}},{key:"setUniformf",value:function(t,e){this.context.uniform1f(this.getUniformLocation(t),e)}},{key:"setUniform2f",value:function(t,e,n){this.context.uniform2f(this.getUniformLocation(t),e,n)}},{key:"setUniform3f",value:function(t,e,n,i){this.context.uniform3f(this.getUniformLocation(t),e,n,i)}},{key:"setUniform4f",value:function(t,e,n,i,r){this.context.uniform4f(this.getUniformLocation(t),e,n,i,r)}},{key:"setUniform2x2f",value:function(t,e){var n=this.context;this.tmp2x2.set(e),n.uniformMatrix2fv(this.getUniformLocation(t),!1,this.tmp2x2)}},{key:"setUniform3x3f",value:function(t,e){var n=this.context;this.tmp3x3.set(e),n.uniformMatrix3fv(this.getUniformLocation(t),!1,this.tmp3x3)}},{key:"setUniform4x4f",value:function(t,e){var n=this.context;this.tmp4x4.set(e),n.uniformMatrix4fv(this.getUniformLocation(t),!1,this.tmp4x4)}},{key:"getUniformLocation",value:function(t){var e=this.context,n=e.getUniformLocation(this.program,t);if(!n&&!e.isContextLost())throw new Error("Couldn't find location for uniform ".concat(t));return n}},{key:"getAttributeLocation",value:function(t){var e=this.context,n=e.getAttribLocation(this.program,t);if(-1===n&&!e.isContextLost())throw new Error("Couldn't find location for attribute ".concat(t));return n}},{key:"dispose",value:function(){var t=this.context;this.vs&&(t.deleteShader(this.vs),this.vs=null),this.fs&&(t.deleteShader(this.fs),this.fs=null),this.program&&(t.deleteProgram(this.program),this.program=null)}}],[{key:"newColoredTextured",value:function(e){return new t(e,"\n         attribute vec4 ".concat(t.POSITION,";\n         attribute vec4 ").concat(t.COLOR,";\n         attribute vec2 ").concat(t.TEXCOORDS,";\n         uniform mat4 ").concat(t.MVP_MATRIX,";\n         varying vec4 v_color;\n         varying vec2 v_texCoords;\n \n         void main () {\n           v_color = ").concat(t.COLOR,";\n           v_texCoords = ").concat(t.TEXCOORDS,";\n           gl_Position = ").concat(t.MVP_MATRIX," * ").concat(t.POSITION,";\n         }\n       "),"\n         #ifdef GL_ES\n           #define LOWP lowp\n           precision mediump float;\n         #else\n           #define LOWP\n         #endif\n         varying LOWP vec4 v_color;\n         varying vec2 v_texCoords;\n         uniform sampler2D u_texture;\n \n         void main () {\n           gl_FragColor = v_color * texture2D(u_texture, v_texCoords);\n         }\n       ")}},{key:"newTwoColoredTextured",value:function(e){return new t(e,"\n         attribute vec4 ".concat(t.POSITION,";\n         attribute vec4 ").concat(t.COLOR,";\n         attribute vec4 ").concat(t.COLOR2,";\n         attribute vec2 ").concat(t.TEXCOORDS,";\n         uniform mat4 ").concat(t.MVP_MATRIX,";\n         varying vec4 v_light;\n         varying vec4 v_dark;\n         varying vec2 v_texCoords;\n \n         void main () {\n           v_light = ").concat(t.COLOR,";\n           v_dark = ").concat(t.COLOR2,";\n           v_texCoords = ").concat(t.TEXCOORDS,";\n           gl_Position = ").concat(t.MVP_MATRIX," * ").concat(t.POSITION,";\n         }\n       "),"\n         #ifdef GL_ES\n           #define LOWP lowp\n           precision mediump float;\n         #else\n           #define LOWP\n         #endif\n         varying LOWP vec4 v_light;\n         varying LOWP vec4 v_dark;\n         varying vec2 v_texCoords;\n         uniform sampler2D u_texture;\n \n         void main () {\n           vec4 texColor = texture2D(u_texture, v_texCoords);\n           gl_FragColor.a = texColor.a * v_light.a;\n           gl_FragColor.rgb = ((texColor.a - 1.0) * v_dark.a + 1.0 - texColor.rgb) * v_dark.rgb + texColor.rgb * v_light.rgb;\n         }\n       ")}},{key:"newColored",value:function(e){return new t(e,"\n         attribute vec4 ".concat(t.POSITION,";\n         attribute vec4 ").concat(t.COLOR,";\n         uniform mat4 ").concat(t.MVP_MATRIX,";\n         varying vec4 v_color;\n \n         void main () {\n           v_color = ").concat(t.COLOR,";\n           gl_Position = ").concat(t.MVP_MATRIX," * ").concat(t.POSITION,";\n         }\n       "),"\n         #ifdef GL_ES\n           #define LOWP lowp\n           precision mediump float;\n         #else\n           #define LOWP\n         #endif\n         varying LOWP vec4 v_color;\n \n         void main () {\n           gl_FragColor = v_color;\n         }\n       ")}}]),t}();e.Shader=o,o.MVP_MATRIX="u_projTrans",o.POSITION="a_position",o.COLOR="a_color",o.COLOR2="a_color2",o.TEXCOORDS="a_texCoords",o.SAMPLER="u_texture"},2438:function(t,e,n){"use strict";var i=n(6690).default,r=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ShapeRenderer=e.ShapeType=void 0;var o,s=n(4731),a=n(6403),h=n(8637),u=n(3192);!function(t){t[t.Point=0]="Point",t[t.Line=1]="Line",t[t.Filled=4]="Filled"}(o=e.ShapeType||(e.ShapeType={}));var l=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10920;if(i(this,t),this.isDrawing=!1,this.shapeType=o.Filled,this.color=new h.Color(1,1,1,1),this.vertexIndex=0,this.tmp=new u.Vector2,this.projectionValues=new Float32Array(16),n>10920)throw new Error("Can't have more than 10920 triangles per batch: "+n);this.context=e,this.mesh=new s.Mesh(e,[new s.Position2Attribute,new s.ColorAttribute],n,0);var r=this.context;this.srcColorBlend=r.SRC_ALPHA,this.srcAlphaBlend=r.ONE,this.dstBlend=r.ONE_MINUS_SRC_ALPHA,this.shader=a.Shader.newColored(r)}return r(t,[{key:"setProjection",value:function(t){this.projectionValues=t}},{key:"begin",value:function(){if(this.isDrawing)throw new Error("ShapeRenderer.begin() has already been called");this.vertexIndex=0,this.isDrawing=!0,this.shader.bind(),this.shader.setUniform4x4f(a.Shader.MVP_MATRIX,this.projectionValues);var t=this.context;t.enable(t.BLEND),t.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)}},{key:"setBlendMode",value:function(t,e,n){(this.srcColorBlend=t,this.srcAlphaBlend=e,this.dstBlend=n,this.isDrawing)&&(this.flush(),this.context.blendFuncSeparate(t,n,e,n))}},{key:"setColor",value:function(t){this.color.setFromColor(t)}},{key:"setColorWith",value:function(t,e,n,i){this.color.set(t,e,n,i)}},{key:"point",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.check(o.Point,1),null===n&&(n=this.color),this.vertex(t,e,n)}},{key:"line",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.check(o.Line,2),null===r&&(r=this.color),this.vertex(t,e,r),this.vertex(n,i,r)}},{key:"triangle",value:function(t,e,n,i,r,s,a){var h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null;this.check(t?o.Filled:o.Line,3),null===h&&(h=this.color),null===u&&(u=this.color),null===l&&(l=this.color),t?(this.vertex(e,n,h),this.vertex(i,r,u),this.vertex(s,a,l)):(this.vertex(e,n,h),this.vertex(i,r,u),this.vertex(i,r,h),this.vertex(s,a,u),this.vertex(s,a,h),this.vertex(e,n,u))}},{key:"quad",value:function(t,e,n,i,r,s,a,h,u){var l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,f=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,v=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null;this.check(t?o.Filled:o.Line,3),null===l&&(l=this.color),null===c&&(c=this.color),null===f&&(f=this.color),null===v&&(v=this.color),t?(this.vertex(e,n,l),this.vertex(i,r,c),this.vertex(s,a,f),this.vertex(s,a,f),this.vertex(h,u,v),this.vertex(e,n,l)):(this.vertex(e,n,l),this.vertex(i,r,c),this.vertex(i,r,c),this.vertex(s,a,f),this.vertex(s,a,f),this.vertex(h,u,v),this.vertex(h,u,v),this.vertex(e,n,l))}},{key:"rect",value:function(t,e,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;this.quad(t,e,n,e+i,n,e+i,n+r,e,n+r,o,o,o,o)}},{key:"rectLine",value:function(t,e,n,i,r,s){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.check(t?o.Filled:o.Line,8),null===a&&(a=this.color);var h=this.tmp.set(r-n,e-i);h.nor(),s*=.5;var u=h.x*s,l=h.y*s;t?(this.vertex(e+u,n+l,a),this.vertex(e-u,n-l,a),this.vertex(i+u,r+l,a),this.vertex(i-u,r-l,a),this.vertex(i+u,r+l,a),this.vertex(e-u,n-l,a)):(this.vertex(e+u,n+l,a),this.vertex(e-u,n-l,a),this.vertex(i+u,r+l,a),this.vertex(i-u,r-l,a),this.vertex(i+u,r+l,a),this.vertex(e+u,n+l,a),this.vertex(i-u,r-l,a),this.vertex(e-u,n-l,a))}},{key:"x",value:function(t,e,n){this.line(t-n,e-n,t+n,e+n),this.line(t-n,e+n,t+n,e-n)}},{key:"polygon",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(n<3)throw new Error("Polygon must contain at least 3 vertices");this.check(o.Line,2*n),null===i&&(i=this.color),n<<=1;for(var r=t[e<<=1],s=t[e+1],a=e+n,h=e,u=e+n-2;h<u;h+=2){var l=t[h],c=t[h+1],f=0,v=0;h+2>=a?(f=r,v=s):(f=t[h+2],v=t[h+3]),this.vertex(l,c,i),this.vertex(f,v,i)}}},{key:"circle",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(0===s&&(s=Math.max(1,6*h.MathUtils.cbrt(i)|0)),s<=0)throw new Error("segments must be > 0.");null===r&&(r=this.color);var a=2*h.MathUtils.PI/s,u=Math.cos(a),l=Math.sin(a),c=i,f=0;if(t){this.check(o.Filled,3*s+3),s--;for(var v=0;v<s;v++){this.vertex(e,n,r),this.vertex(e+c,n+f,r);var d=c;c=u*c-l*f,f=l*d+u*f,this.vertex(e+c,n+f,r)}this.vertex(e,n,r),this.vertex(e+c,n+f,r)}else{this.check(o.Line,2*s+2);for(var p=0;p<s;p++){this.vertex(e+c,n+f,r);var y=c;c=u*c-l*f,f=l*y+u*f,this.vertex(e+c,n+f,r)}this.vertex(e+c,n+f,r)}c=i,f=0,this.vertex(e+c,n+f,r)}},{key:"curve",value:function(t,e,n,i,r,s,a,h,u){var l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null;this.check(o.Line,2*u+2),null===l&&(l=this.color);for(var c=1/u,f=c*c,v=c*c*c,d=3*c,p=3*f,y=6*f,M=6*v,g=t-2*n+r,x=e-2*i+s,m=3*(n-r)-t+a,w=3*(i-s)-e+h,k=t,b=e,_=(n-t)*d+g*p+m*v,T=(i-e)*d+x*p+w*v,E=g*y+m*M,A=x*y+w*M,L=m*M,P=w*M;u-- >0;)this.vertex(k,b,l),k+=_,b+=T,_+=E,T+=A,E+=L,A+=P,this.vertex(k,b,l);this.vertex(k,b,l),this.vertex(a,h,l)}},{key:"vertex",value:function(t,e,n){var i=this.vertexIndex,r=this.mesh.getVertices();r[i++]=t,r[i++]=e,r[i++]=n.r,r[i++]=n.g,r[i++]=n.b,r[i++]=n.a,this.vertexIndex=i}},{key:"end",value:function(){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");this.flush();var t=this.context;t.disable(t.BLEND),this.isDrawing=!1}},{key:"flush",value:function(){0!==this.vertexIndex&&(this.mesh.setVerticesLength(this.vertexIndex),this.mesh.draw(this.shader,this.shapeType),this.vertexIndex=0)}},{key:"check",value:function(t,e){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");if(this.shapeType===t){if(!(this.mesh.maxVertices()-this.mesh.numVertices()<e))return;this.flush()}else this.flush(),this.shapeType=t}},{key:"dispose",value:function(){this.mesh.dispose()}}]),t}();e.ShapeRenderer=l},9805:function(t,e,n){"use strict";var i=n(6690).default,r=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Sprite=void 0;var o=n(8637),s=n(3192),a=function(){function t(e){i(this,t),this.region=e,this.dirty=!1,this.position=new s.Vector2(0,0),this.size=new s.Vector2(0,0),this.origin=new s.Vector2(0,0),this.scale=new s.Vector2(1,1),this.color=new o.Color(1,1,1,1),this.rotation=0,this.vertices=new Float32Array(48),this.bounds={x:0,y:0,width:0,height:0},this.setSize(e.width,e.height),this.setOrigin(e.width/2,e.height/2)}return r(t,[{key:"set",value:function(t){this.region=t.region,this.position.setVector(t.position),this.size.setVector(t.size),this.origin.setVector(t.origin),this.rotation=t.rotation,this.scale.setVector(t.scale),this.color.setFromColor(t.color),this.dirty=!0}},{key:"setBounds",value:function(t,e,n,i){this.setPosition(t,e),this.setSize(t,e),this.dirty=!0}},{key:"setSize",value:function(t,e){this.size.set(t,e),this.dirty=!0}},{key:"setPosition",value:function(t,e){this.position.set(t,e),this.dirty=!0}},{key:"setOriginBasedPosition",value:function(t,e){this.setPosition(t-this.origin.x,e-this.origin.y)}},{key:"setX",value:function(t){this.position.x=t,this.dirty=!0}},{key:"setY",value:function(t){this.position.y=t,this.dirty=!0}},{key:"setCenterX",value:function(t){this.setX(t-this.size.x/2)}},{key:"setCenterY",value:function(t){this.setY(t-this.size.y/2)}},{key:"setCenter",value:function(t,e){this.setPosition(t-this.size.x/2,e-this.size.y/2)}},{key:"translateX",value:function(t){this.translate(t,0)}},{key:"translateY",value:function(t){this.translate(0,t)}},{key:"translate",value:function(t,e){this.position.add(t,e),this.dirty=!0}},{key:"setColor",value:function(t){this.color.setFromColor(t),this.dirty=!0}},{key:"setAlpha",value:function(t){this.color.a=t,this.dirty=!0}},{key:"setOrigin",value:function(t,e){this.origin.set(t,e),this.dirty=!0}},{key:"setOriginCenter",value:function(){this.origin.set(this.size.x/2,this.size.y/2),this.dirty=!0}},{key:"setRotation",value:function(t){this.rotation=t,this.dirty=!0}},{key:"getRotation",value:function(){return this.rotation}},{key:"rotate",value:function(t){0!==t&&(this.rotation+=t,this.dirty=!0)}},{key:"setScale",value:function(t,e){this.scale.set(t,e),this.dirty=!0}},{key:"applyScale",value:function(t){this.scale.scale(t),this.dirty=!0}},{key:"getVertices",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.vertices,n=this.region;if(!this.dirty)return e;var i=this.position.x,r=this.position.y,o=this.size.x,s=this.size.y,a=this.origin.x,h=this.origin.y,u=this.rotation,l=this.scale.x,c=this.scale.y,f=n.u,v=n.v,d=n.u2,p=n.v2,y=this.color,M=n.rotated,g=o/n.originalWidth,x=s/n.originalHeight,m=n.width*g,w=n.height*x,k=i+n.offsetX*g;if(i=k,r=t?r+s-n.offsetY*x-w:r+n.offsetY*x,t){var b=v;v=p,p=b}var _=-a,T=(o=m)-a,E=o-a,A=-a,L=-h,P=-h,C=(s=w)-h,S=s-h;if(1!==l&&(_*=l,T*=l,E*=l,A*=l),1!==c&&(L*=c,P*=c,C*=c,S*=c),0!==u){var O=Math.cos(u),R=Math.sin(u),I=O*_-R*L,V=R*_+O*L,F=O*T-R*P,G=R*T+O*P,D=O*E-R*C,z=R*E+O*C,j=O*A-R*S,B=R*A+O*S;_=I,T=F,E=D,A=j,L=V,P=G,C=z,S=B}_+=i+a,T+=i+a,E+=i+a,A+=i+a,L+=r+h,P+=r+h,C+=r+h,S+=r+h;var N=f,U=v,X=d,H=p,W=X,Y=U,Z=N,q=H;M&&(t?(N=f,U=p,X=d,H=v,W=f,Y=v,Z=d,q=p):(N=d,U=v,X=f,H=p,W=d,Y=p,Z=f,q=v));var K=0;return e[K++]=_,e[K++]=L,e[K++]=y.r,e[K++]=y.g,e[K++]=y.b,e[K++]=y.a,e[K++]=N,e[K++]=U,e[K++]=0,e[K++]=0,e[K++]=0,e[K++]=0,e[K++]=T,e[K++]=P,e[K++]=y.r,e[K++]=y.g,e[K++]=y.b,e[K++]=y.a,e[K++]=W,e[K++]=Y,e[K++]=0,e[K++]=0,e[K++]=0,e[K++]=0,e[K++]=E,e[K++]=C,e[K++]=y.r,e[K++]=y.g,e[K++]=y.b,e[K++]=y.a,e[K++]=X,e[K++]=H,e[K++]=0,e[K++]=0,e[K++]=0,e[K++]=0,e[K++]=A,e[K++]=S,e[K++]=y.r,e[K++]=y.g,e[K++]=y.b,e[K++]=y.a,e[K++]=Z,e[K++]=q,e[K++]=0,e[K++]=0,e[K++]=0,e[K]=0,e}},{key:"getBoundingRectangle",value:function(){var t=this.vertices,e=t[0],n=t[1],i=t[0],r=t[1];return e=(e=(e=e>t[12]?t[12]:e)>t[24]?t[24]:e)>t[36]?t[36]:e,i=(i=(i=i<t[12]?t[12]:i)<t[24]?t[24]:i)<t[36]?t[36]:i,n=(n=(n=n>t[13]?t[13]:n)>t[25]?t[25]:n)>t[37]?t[37]:n,r=(r=(r=r<t[13]?t[13]:r)<t[25]?t[25]:r)<t[37]?t[37]:r,this.bounds.x=e,this.bounds.y=n,this.bounds.width=i-e,this.bounds.height=r-n,this.bounds}},{key:"draw",value:function(t){t.drawVertices(this.region.texture,this.getVertices(t.yDown))}},{key:"drawWithAlpha",value:function(t,e){var n=this.getColor().a;this.setAlpha(n*e),this.draw(t),this.setAlpha(n)}},{key:"getX",value:function(){return this.position.x}},{key:"getY",value:function(){return this.position.y}},{key:"getWidth",value:function(){return this.size.x}},{key:"getHeight",value:function(){return this.size.y}},{key:"getOriginX",value:function(){return this.origin.x}},{key:"getOriginY",value:function(){return this.origin.y}},{key:"getScaleX",value:function(){return this.scale.x}},{key:"getScaleY",value:function(){return this.scale.y}},{key:"getColor",value:function(){return this.color}}]),t}();e.Sprite=a},3432:function(t,e,n){"use strict";var i,r=n(6690).default,o=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Texture=e.TextureWrap=e.TextureFilter=void 0,function(t){t[t.Nearest=9728]="Nearest",t[t.Linear=9729]="Linear",t[t.MipMap=9987]="MipMap",t[t.MipMapNearestNearest=9984]="MipMapNearestNearest",t[t.MipMapLinearNearest=9985]="MipMapLinearNearest",t[t.MipMapNearestLinear=9986]="MipMapNearestLinear",t[t.MipMapLinearLinear=9987]="MipMapLinearLinear"}(i=e.TextureFilter||(e.TextureFilter={})),function(t){t[t.MirroredRepeat=33648]="MirroredRepeat",t[t.ClampToEdge=33071]="ClampToEdge",t[t.Repeat=10497]="Repeat"}(e.TextureWrap||(e.TextureWrap={}));var s=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r(this,t),this.texture=null,this.boundUnit=0,this.useMipMaps=!1,this.width=0,this.height=0,this._image=n,this.context=e,this.useMipMaps=i,this.restore(),this.width=n.width,this.height=n.height}return o(t,[{key:"getImage",value:function(){return this._image}},{key:"getWebGLTexture",value:function(){return this.texture}},{key:"setFilters",value:function(e,n){var i=this.context;this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t.validateMagFilter(n))}},{key:"setWraps",value:function(t,e){var n=this.context;this.bind(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,e)}},{key:"update",value:function(e){var n=this.context;this.texture||(this.texture=this.context.createTexture()),this.bind(),t.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL&&n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,this._image),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e?n.LINEAR_MIPMAP_LINEAR:n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),e&&n.generateMipmap(n.TEXTURE_2D)}},{key:"restore",value:function(){this.texture=null,this.update(this.useMipMaps)}},{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.context;this.boundUnit=t,e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this.texture)}},{key:"unbind",value:function(){var t=this.context;t.activeTexture(t.TEXTURE0+this.boundUnit),t.bindTexture(t.TEXTURE_2D,null)}},{key:"dispose",value:function(){this.context.deleteTexture(this.texture)}}],[{key:"load",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(r){var o=new Image;o.onload=function(){r(new t(e,o,i))},o.src=n}))}},{key:"validateMagFilter",value:function(t){switch(t){case i.MipMap:case i.MipMapLinearLinear:case i.MipMapLinearNearest:case i.MipMapNearestLinear:case i.MipMapNearestNearest:return i.Linear;default:return t}}}]),t}();e.Texture=s,s.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL=!1},8143:function(t,e,n){"use strict";var i=n(7061).default,r=n(7424).default,o=n(4704).default,s=n(6690).default,a=n(9728).default,h=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{h(i.next(t))}catch(e){o(e)}}function a(t){try{h(i.throw(t))}catch(e){o(e)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}h((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.TextureAtlas=void 0;var u=n(3432),l=n(8026);function c(t,e){for(var n=t.split("/"),i=e.split("/"),r=[],o=0,s=n.length;o<s;o++)if(".."===n[o])r.pop();else{if("."===n[o])continue;r.push(n[o])}for(var a=0,h=i.length;a<h;a++)if(".."===i[a])r.pop();else{if("."===i[a])continue;r.push(i[a])}return r.join("/")}var f=function(){function t(e,n){s(this,t),this.pages=e,this.regions=n}return a(t,[{key:"dispose",value:function(){var t,e=o(this.pages);try{for(e.s();!(t=e.n()).done;){t.value.dispose()}}catch(n){e.e(n)}finally{e.f()}}},{key:"getPages",value:function(){return this.pages}},{key:"getRegions",value:function(){return this.regions}},{key:"findRegion",value:function(t,e){for(var n=0;n<this.regions.length;n++){var i=this.regions[n];if(i.name===t&&(void 0===e||i.index===e))return i}return null}},{key:"findRegions",value:function(t){return this.regions.filter((function(e){return e.name===t})).sort((function(t,e){return t.index-e.index}))}}],[{key:"load",value:function(e,n,o){return h(this,void 0,void 0,i().mark((function s(){var a,h,f,v,d,p,y,M,g,x,m,w,k,b,_,T,E,A,L,P,C,S,O,R,I,V,F,G,D,z,j,B,N,U,X,H,W,Y,Z,q,K;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,fetch(n).then((function(t){return t.text()}));case 2:a=i.sent,h=[],f=[],v=[],p=a.split(/\r?\n/),y=0;case 8:if(void 0!==(g=p[y])){i.next=12;break}return i.abrupt("break",16);case 12:0===g.trim().length?d=null:null===d?(x=c(n,"../".concat(g)),y++,g=p[y],M=g.split(":")[1].split(",").map((function(t){return t.trim()})),m=parseInt(M[0],10),w=parseInt(M[1],10),y++,g=p[y],M=g.split(":")[1].split(",").map((function(t){return t.trim()})),k=M[0],y++,g=p[y],M=g.split(":")[1].split(",").map((function(t){return t.trim()})),b=r(M,2),_=b[0],T=b[1],y++,g=p[y],M=g.split(":")[1].split(",").map((function(t){return t.trim()})),E=M[0],A=u.TextureWrap.ClampToEdge,L=u.TextureWrap.ClampToEdge,"x"===E?A=u.TextureWrap.Repeat:"y"===E?L=u.TextureWrap.Repeat:"xy"===E&&(A=u.TextureWrap.Repeat,L=u.TextureWrap.Repeat),d={file:x,width:m,height:w,format:k,mipMaps:"Nearest"!==_&&"Linear"!==_,min:_,max:T,direction:E,repeatX:A,repeatY:L},h.push(d)):(P=g,y++,g=p[y],M=g.split(":")[1].split(",").map((function(t){return t.trim()})),C="true"===M[0],y++,g=p[y],M=g.split(":")[1].split(",").map((function(t){return t.trim()})),S=parseInt(M[0],10),O=parseInt(M[1],10),y++,g=p[y],M=g.split(":")[1].split(",").map((function(t){return t.trim()})),R=parseInt(M[0],10),I=parseInt(M[1],10),V={name:P,rotate:C,left:S,top:O,width:R,height:I,page:d},y++,g=p[y],4===(M=g.split(":")[1].split(",").map((function(t){return t.trim()}))).length&&(V.splits=M.map((function(t){return parseInt(t,10)})),y++,g=p[y],4===(M=g.split(":")[1].split(",").map((function(t){return t.trim()}))).length&&(V.pads=M.map((function(t){return parseInt(t,10)})),y++,g=p[y],M=g.split(":")[1].split(",").map((function(t){return t.trim()})))),V.originalWidth=parseInt(M[0],10),V.originalHeight=parseInt(M[1],10),y++,g=p[y],M=g.split(":")[1].split(",").map((function(t){return t.trim()})),V.offsetX=parseInt(M[0],10),V.offsetY=parseInt(M[1],10),y++,g=p[y],M=g.split(":")[1].split(",").map((function(t){return t.trim()})),V.index=parseInt(M[0],10),v.push(V)),y++,i.next=8;break;case 16:F=0,G=h;case 17:if(!(F<G.length)){i.next=27;break}return D=G[F],i.next=21,u.Texture.load(e,D.file,o);case 21:D.texture=i.sent,D.invTexWidth=1/D.texture.width,D.invTexHeight=1/D.texture.height;case 24:F++,i.next=17;break;case 27:for(z=[],j=0,B=v;j<B.length;j++)N=B[j],U=N.left,X=N.top,H=N.rotate?N.height:N.width,W=N.rotate?N.width:N.height,Y=N.page,Z=Y.texture,q=Y.invTexWidth,K=Y.invTexHeight,z.push(new l.TextureRegion(Z,U,X,H,W,N,q,K,N.rotate));return i.abrupt("return",new t(f,z));case 30:case"end":return i.stop()}}),s)})))}}]),t}();e.TextureAtlas=f},8026:function(t,e,n){"use strict";var i=n(6690).default,r=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.TextureRegion=void 0;var o=function(){function t(e,n,r,o,s,a,h,u){var l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];i(this,t),this.name=null,this.index=0,this.texture=null,this.regionX=0,this.regionY=0,this.width=0,this.height=0,this.invTexWidth=0,this.invTexHeight=0,this.originalWidth=0,this.originalHeight=0,this.offsetX=0,this.offsetY=0,this.u=0,this.v=0,this.u2=0,this.v2=0,this.rotated=!1,h&&u||(h=1/e.width,u=1/e.height);var c=n*h,f=(r+s)*u,v=(n+o)*h,d=r*u;for(var p in this.texture=e,this.regionX=n,this.regionY=r,this.width=o,this.height=s,this.originalWidth=o,this.originalHeight=s,this.offsetX=0,this.offsetY=0,this.u=c,this.v=f,this.u2=v,this.v2=d,this.rotated=l,a)this[p]=a[p]}return r(t,[{key:"draw",value:function(t,e,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,l=this.originalWidth,c=this.originalHeight,f=this.offsetX,v=this.offsetY,d=this.width,p=this.height,y=i/l,M=r/c,g=d*y,x=p*M,m=e+f*y,w=0;o-=m-e,s-=(w=t.yDown?n+r-v*M-x:n+v*M)-n,t.draw(this.texture,m,w,g,x,o,s,a,h,u,this.u,this.v,this.u2,this.v2,this.rotated)}}],[{key:"splitTexture",value:function(e,n,i){for(var r=e.width/n,o=e.height/i,s=[],a=0;a<i;a++)for(var h=0;h<n;h++)s.push(new t(e,h*r,a*o,r,o,{}));return s}}]),t}();e.TextureRegion=o},8637:function(t,e,n){"use strict";var i,r=n(1655).default,o=n(6389).default,s=n(6690).default,a=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.copyArray=e.createStage=e.pointInRect=e.resizeCanvas=e.createGameLoop=e.WindowedMean=e.TimeKeeper=e.Pools=e.Pool=e.Utils=e.PowOut=e.Pow=e.Interpolation=e.MathUtils=e.Color=e.StringSet=e.IntSet=e.Align=void 0;var h=function(){function t(){s(this,t)}return a(t,null,[{key:"isLeft",value:function(t){return 0!==(t&this.left)}},{key:"isRight",value:function(t){return 0!==(t&this.right)}},{key:"isTop",value:function(t){return 0!==(t&this.top)}},{key:"isBottom",value:function(t){return 0!==(t&this.bottom)}},{key:"isCenterVertical",value:function(t){return 0===(t&this.top)&&0===(t&this.bottom)}},{key:"isCenterHorizontal",value:function(t){return 0===(t&this.left)&&0===(t&this.right)}}]),t}();e.Align=h,i=h,h.center=1,h.top=2,h.bottom=4,h.left=8,h.right=16,h.topLeft=i.top|i.left,h.topRight=i.top|i.right,h.bottomLeft=i.bottom|i.left,h.bottomRight=i.bottom|i.right;var u=function(){function t(){s(this,t),this.array=new Array}return a(t,[{key:"add",value:function(t){var e=this.contains(t);return this.array[0|t]=0|t,!e}},{key:"contains",value:function(t){return void 0!==this.array[0|t]}},{key:"remove",value:function(t){this.array[0|t]=void 0}},{key:"clear",value:function(){this.array.length=0}}]),t}();e.IntSet=u;var l=function(){function t(){s(this,t),this.entries={},this.size=0}return a(t,[{key:"add",value:function(t){var e=this.entries[t];return this.entries[t]=!0,!e&&(this.size++,!0)}},{key:"addAll",value:function(t){for(var e=this.size,n=0,i=t.length;n<i;n++)this.add(t[n]);return e!==this.size}},{key:"contains",value:function(t){return this.entries[t]}},{key:"clear",value:function(){this.entries={},this.size=0}}]),t}();e.StringSet=l;var c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;s(this,t),this.r=e,this.g=n,this.b=i,this.a=r}return a(t,[{key:"unsafeSet",value:function(t,e,n,i){this.r=t,this.g=e,this.b=n,this.a=i}},{key:"set",value:function(t,e,n,i){return this.r=t,this.g=e,this.b=n,this.a=i,this.clamp()}},{key:"setFromColor",value:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}},{key:"setFromString",value:function(t){return t="#"===t.charAt(0)?t.substring(1):t,this.r=parseInt(t.substring(0,2),16)/255,this.g=parseInt(t.substring(2,4),16)/255,this.b=parseInt(t.substring(4,6),16)/255,this.a=8!==t.length?1:parseInt(t.substring(6,8),16)/255,this}},{key:"add",value:function(t,e,n,i){return this.r+=t,this.g+=e,this.b+=n,this.a+=i,this.clamp()}},{key:"clamp",value:function(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}},{key:"toIntBits",value:function(){return 255*this.a<<24|255*this.b<<16|255*this.g<<8|255*this.r}}],[{key:"rgba8888ToColor",value:function(t,e){t.r=((4278190080&e)>>>24)/255,t.g=((16711680&e)>>>16)/255,t.b=((65280&e)>>>8)/255,t.a=(255&e)/255}},{key:"rgb888ToColor",value:function(t,e){t.r=((16711680&e)>>>16)/255,t.g=((65280&e)>>>8)/255,t.b=(255&e)/255}},{key:"fromString",value:function(e){return(new t).setFromString(e)}}]),t}();e.Color=c,c.WHITE=new c(1,1,1,1),c.RED=new c(1,0,0,1),c.GREEN=new c(0,1,0,1),c.BLUE=new c(0,0,1,1),c.MAGENTA=new c(1,0,1,1);var f=function(){function t(){s(this,t)}return a(t,null,[{key:"clamp",value:function(t,e,n){return t<e?e:t>n?n:t}},{key:"cosDeg",value:function(e){return Math.cos(e*t.degRad)}},{key:"sinDeg",value:function(e){return Math.sin(e*t.degRad)}},{key:"signum",value:function(t){return t>0?1:t<0?-1:0}},{key:"toInt",value:function(t){return t>0?Math.floor(t):Math.ceil(t)}},{key:"cbrt",value:function(t){var e=Math.pow(Math.abs(t),1/3);return t<0?-e:e}},{key:"randomTriangular",value:function(e,n){return t.randomTriangularWith(e,n,.5*(e+n))}},{key:"randomTriangularWith",value:function(t,e,n){var i=Math.random(),r=e-t;return i<=(n-t)/r?t+Math.sqrt(i*r*(n-t)):e-Math.sqrt((1-i)*r*(e-n))}},{key:"isPowerOfTwo",value:function(t){return t&&0===(t&t-1)}}]),t}();e.MathUtils=f,f.PI=3.1415927,f.PI2=2*f.PI,f.radiansToDegrees=180/f.PI,f.radDeg=f.radiansToDegrees,f.degreesToRadians=f.PI/180,f.degRad=f.degreesToRadians;var v=function(){function t(){s(this,t)}return a(t,[{key:"apply",value:function(t,e,n){return t+(e-t)*this.applyInternal(n)}}]),t}();e.Interpolation=v;var d=function(t){r(n,t);var e=o(n);function n(t){var i;return s(this,n),(i=e.call(this)).power=2,i.power=t,i}return a(n,[{key:"applyInternal",value:function(t){return t<=.5?Math.pow(2*t,this.power)/2:Math.pow(2*(t-1),this.power)/(this.power%2===0?-2:2)+1}}]),n}(v);e.Pow=d;var p=function(t){r(n,t);var e=o(n);function n(){return s(this,n),e.apply(this,arguments)}return a(n,[{key:"applyInternal",value:function(t){return Math.pow(t-1,this.power)*(this.power%2===0?-1:1)+1}}]),n}(d);e.PowOut=p;var y=function(){function t(){s(this,t)}return a(t,null,[{key:"arrayCopy",value:function(t,e,n,i,r){for(var o=e,s=i;o<e+r;o++,s++)n[s]=t[o]}},{key:"arrayFill",value:function(t,e,n,i){for(var r=e;r<n;r++)t[r]=i}},{key:"setArraySize",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=t.length;if(i===e)return t;if(t.length=e,i<e)for(var r=i;r<e;r++)t[r]=n;return t}},{key:"ensureArrayCapacity",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.length>=n?e:t.setArraySize(e,n,i)}},{key:"newArray",value:function(t,e){for(var n=new Array(t),i=0;i<t;i++)n[i]=e;return n}},{key:"newFloatArray",value:function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Float32Array(e);for(var n=new Array(e),i=0;i<n.length;i++)n[i]=0;return n}},{key:"newShortArray",value:function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Int16Array(e);for(var n=new Array(e),i=0;i<n.length;i++)n[i]=0;return n}},{key:"toFloatArray",value:function(e){return t.SUPPORTS_TYPED_ARRAYS?new Float32Array(e):e}},{key:"toSinglePrecision",value:function(e){return t.SUPPORTS_TYPED_ARRAYS?Math.fround(e):e}},{key:"contains",value:function(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return!1}},{key:"enumValue",value:function(t,e){return t[e[0].toUpperCase()+e.slice(1)]}}]),t}();e.Utils=y,y.SUPPORTS_TYPED_ARRAYS="undefined"!==typeof Float32Array;var M=function(){function t(e){s(this,t),this.items=new Array,this.instantiator=e||function(){return{}}}return a(t,[{key:"obtain",value:function(){return this.items.length>0?this.items.pop():this.instantiator()}},{key:"free",value:function(t){(null===t||void 0===t?void 0:t.reset)&&t.reset(),this.items.push(t)}},{key:"freeAll",value:function(t){for(var e=0;e<t.length;e++)this.free(t[e])}},{key:"clear",value:function(){this.items.length=0}}]),t}();e.Pool=M;var g=function(){function t(){s(this,t)}return a(t,null,[{key:"free",value:function(t,e){this.pools[t]&&this.pools[t].free(e)}},{key:"freeAll",value:function(t,e){this.pools[t]&&this.pools[t].freeAll(e)}},{key:"get",value:function(t,e){return this.pools[t]||(this.pools[t]=new M(e)),this.pools[t]}},{key:"set",value:function(t,e){this.pools[t]=e}},{key:"obtain",value:function(t,e){return this.get(t,e).obtain()}}]),t}();e.Pools=g,g.pools={};var x=function(){function t(){s(this,t),this.maxDelta=.064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}return a(t,[{key:"update",value:function(){var t=Date.now()/1e3;this.delta=t-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=t,this.frameCount++,this.frameTime>1&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)}}]),t}();e.TimeKeeper=x;var m=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;s(this,t),this.addedValues=0,this.lastValue=0,this.mean=0,this.dirty=!0,this.values=new Array(e)}return a(t,[{key:"hasEnoughData",value:function(){return this.addedValues>=this.values.length}},{key:"addValue",value:function(t){this.addedValues<this.values.length&&this.addedValues++,this.values[this.lastValue++]=t,this.lastValue>this.values.length-1&&(this.lastValue=0),this.dirty=!0}},{key:"getMean",value:function(){if(this.hasEnoughData()){if(this.dirty){for(var t=0,e=0;e<this.values.length;e++)t+=this.values[e];this.mean=t/this.values.length,this.dirty=!1}return this.mean}return 0}}]),t}();e.WindowedMean=m;e.createGameLoop=function(t){var e,n=Date.now(),i=0,r=!0,o=0,s=0;function a(){if(r){var h=Date.now()-n;n=Date.now(),o++,(s+=h)>=1e3&&(i=o,o=0,s-=1e3),e=requestAnimationFrame(a),t(h/1e3)}}return a(),{isRunning:function(){return r},start:function(){r||(r=!0,a())},stop:function(){e&&cancelAnimationFrame(e),r=!1},getFps:function(){return i}}};e.resizeCanvas=function(t,e){var n=e||window.devicePixelRatio||1,i=t.clientWidth*n,r=t.clientHeight*n;return t.width===i&&t.height===r||(t.width=i,t.height=r),[i,r]};e.pointInRect=function(t,e,n,i,r,o){return t>n&&t<n+r&&e>i&&e<i+o};e.createStage=function(t){t=Object.assign(Object.assign({},{hidden:!1,info:!0}),t);var e=document.createElement("div");e.setAttribute("style","position:fixed;top:0;left:0;right:0;bottom:0;"),t.wrapperClassName&&(e.className=t.wrapperClassName),t.hidden&&(e.style.display="none");var n=document.createElement("canvas");n.setAttribute("style","width:100%;height:100%;");var i=document.createElement("div");return i.setAttribute("style","position:absolute;top:1em;left:1em;color:white"),t.info||(i.style.display="none"),e.appendChild(n),e.appendChild(i),document.body.appendChild(e),{getCanvas:function(){return n},getInfo:function(){return i},show:function(){return e.style.display="block"},hide:function(){return e.style.display="none"},cleanup:function(){return document.body.removeChild(e)}}};e.copyArray=function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.length,o=0;o<r;o++)e[n+o]=t[i+o]}},3192:function(t,e,n){"use strict";var i=n(6690).default,r=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Vector2=void 0;var o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;i(this,t),this.x=0,this.y=0,this.x=e,this.y=n}return r(t,[{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"setVector",value:function(t){return this.set(t.x,t.y)}},{key:"add",value:function(t,e){return this.x+=t,this.y+=e,this}},{key:"addVector",value:function(t){return this.add(t.x,t.y)}},{key:"sub",value:function(t,e){return this.add(-t,-e)}},{key:"subVector",value:function(t){return this.sub(t.x,t.y)}},{key:"scale",value:function(t){return this.x*=t,this.y*=t,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"distanceSqr",value:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n}},{key:"distance",value:function(t){return Math.sqrt(this.distanceSqr(t))}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"len2",value:function(){return this.x*this.x+this.y*this.y}},{key:"len",value:function(){return Math.sqrt(this.len2())}},{key:"nor",value:function(){var t=this.len();return 0!==t&&(this.x/=t,this.y/=t),this}},{key:"rotateRad",value:function(t){var e=Math.cos(t),n=Math.sin(t),i=this.x*e-this.y*n,r=this.x*n+this.y*e;return this.x=i,this.y=r,this}},{key:"rotate",value:function(t){return this.rotateRad(t*Math.PI/180)}},{key:"cpy",value:function(){return new t(this.x,this.y)}}]),t}();e.Vector2=o},2668:function(t,e,n){"use strict";var i=n(6690).default,r=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Vector3=void 0;var o=n(5474),s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;i(this,t),this.x=0,this.y=0,this.z=0,this.x=e,this.y=n,this.z=r}return r(t,[{key:"setFrom",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}},{key:"set",value:function(t,e,n){return this.x=t,this.y=e,this.z=n,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}},{key:"scale",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"normalize",value:function(){var t=this.length();return 0===t||(t=1/t,this.x*=t,this.y*=t,this.z*=t),this}},{key:"cross",value:function(t){return this.set(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}},{key:"multiply",value:function(t){var e=t.values;return this.set(this.x*e[o.M00]+this.y*e[o.M01]+this.z*e[o.M02]+e[o.M03],this.x*e[o.M10]+this.y*e[o.M11]+this.z*e[o.M12]+e[o.M13],this.x*e[o.M20]+this.y*e[o.M21]+this.z*e[o.M22]+e[o.M23])}},{key:"project",value:function(t){var e=t.values,n=1/(this.x*e[o.M30]+this.y*e[o.M31]+this.z*e[o.M32]+e[o.M33]);return this.set((this.x*e[o.M00]+this.y*e[o.M01]+this.z*e[o.M02]+e[o.M03])*n,(this.x*e[o.M10]+this.y*e[o.M11]+this.z*e[o.M12]+e[o.M13])*n,(this.x*e[o.M20]+this.y*e[o.M21]+this.z*e[o.M22]+e[o.M23])*n)}},{key:"unproject",value:function(t,e,n,i,r,o){var s=this.x,a=this.y,h=this.z;return s-=n,a=o-a-1,a-=i,t.set(2*s/r-1,2*a/o-1,2*h-1),t.project(e),t}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"distance",value:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z;return Math.sqrt(e*e+n*n+i*i)}}]),t}();e.Vector3=s},7885:function(t,e,n){"use strict";var i=n(4704).default,r=n(7424).default;Object.defineProperty(e,"__esModule",{value:!0}),e.createViewport=void 0;var o=n(814),s=n(8637);e.createViewport=function(t,e,n,a){var h,u={autoUpdate:!0,pixelRatio:void 0,crop:!0};(a=Object.assign(Object.assign({},u),a)).disablePremultipliedAlpha&&(h={premultipliedAlpha:!1}),h=Object.assign(Object.assign({},h),a.contextOption);var l,c=t.getContext("webgl2",h),f=[],v=a,d=v.autoUpdate,p=v.pixelRatio,y=v.crop,M={pixelRatio:p=p||window.devicePixelRatio||1,x:0,y:0,width:e,height:n,worldWidth:e,worldHeight:n},g=(0,s.resizeCanvas)(t,p),x=r(g,2),m=x[0],w=x[1],k=new o.OrthoCamera(e,n,m,w);d&&(l=function(t){b.update()},window.addEventListener("resize",l));var b={getViewportInfo:function(){return M},getCamera:function(){return k},addCamera:function(t){f.push(t)},getContext:function(){return c},getCanvas:function(){return t},update:function(){var o=(0,s.resizeCanvas)(t,p),a=r(o,2),h=a[0],u=a[1],l=e/n,v=h/u;if(y){var d,g;l<v?(g=u,d=u*l):(d=h,g=h/l);var x=(h-d)/2,m=(u-g)/2;M.x=x,M.y=m,M.width=d,M.height=g,c.viewport(x,m,d,g),k.setPosition(e/2,n/2),k.resize(e,n,d,g);var w,b=i(f);try{for(b.s();!(w=b.n()).done;){var _=w.value;_.setPosition(e/2,n/2),_.resize(e,n,d,g)}}catch(O){b.e(O)}finally{b.f()}}else{var T,E,A,L;M.x=0,M.y=0,M.width=h,M.height=u,c.viewport(0,0,h,u),l<v?(A=-((T=(E=n)*v)-e)/2,L=0):(A=0,L=-((E=(T=e)/v)-n)/2),k.setPosition(A+T/2,L+E/2),k.resize(T,E,h,u);var P,C=i(f);try{for(C.s();!(P=C.n()).done;){var S=P.value;S.setPosition(A+T/2,L+E/2),S.resize(T,E,h,u)}}catch(O){C.e(O)}finally{C.f()}}},cleanUp:function(){l&&window.removeEventListener("resize",l)}};return d&&b.update(),b}},4634:function(t,e,n){"use strict";var i=n(6690).default,r=n(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ViewportInputHandler=void 0;var o=n(3233),s=n(3192),a=function(){function t(e){i(this,t),this.screenCoord=new s.Vector2,this.worldCoord=new s.Vector2,this.viewport=e,this.canvas=e.getCanvas(),this.inputHandler=new o.InputHandler(this.canvas)}return r(t,[{key:"isTouched",value:function(){return this.inputHandler.isTouched()}},{key:"cleanup",value:function(){this.inputHandler.cleanup()}},{key:"addEventListener",value:function(t,e){var n,i;this.inputHandler.addEventListener(t,(n=e,i=this.viewport,function(t,e){var r=i.getViewportInfo(),o=r.x,s=r.y,a=r.pixelRatio;n(t=t*a-o,e=e*a-s)}))}},{key:"getX",value:function(){var t=this.viewport.getViewportInfo(),e=t.x,n=t.pixelRatio;return this.inputHandler.getX()*n-e}},{key:"getY",value:function(){var t=this.viewport.getViewportInfo(),e=t.y,n=t.pixelRatio;return this.inputHandler.getY()*n-e}},{key:"getTouchedWorldCoord",value:function(t){return t||(t=this.viewport.getCamera()),this.screenCoord.set(this.getX(),this.getY()),t.unprojectVector2(this.worldCoord,this.screenCoord),this.worldCoord}}]),t}();e.ViewportInputHandler=a},5547:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(n(9054),e),r(n(7035),e),r(n(5283),e),r(n(6735),e),r(n(909),e),r(n(2691),e),r(n(814),e),r(n(2229),e),r(n(5508),e),r(n(417),e),r(n(1013),e),r(n(3233),e),r(n(5474),e),r(n(4731),e),r(n(2226),e),r(n(2991),e),r(n(6403),e),r(n(9805),e),r(n(2438),e),r(n(3432),e),r(n(8143),e),r(n(8026),e),r(n(8637),e),r(n(3192),e),r(n(2668),e),r(n(7885),e),r(n(4634),e)},3897:function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i},t.exports.__esModule=!0,t.exports.default=t.exports},5372:function(t){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports},3405:function(t,e,n){var i=n(3897);t.exports=function(t){if(Array.isArray(t))return i(t)},t.exports.__esModule=!0,t.exports.default=t.exports},6115:function(t){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports},6690:function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},9728:function(t){function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports},4704:function(t,e,n){var i=n(6116);t.exports=function(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=i(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,h=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){h=!0,s=t},f:function(){try{a||null==n.return||n.return()}finally{if(h)throw s}}}},t.exports.__esModule=!0,t.exports.default=t.exports},6389:function(t,e,n){var i=n(3808),r=n(9617),o=n(4993);t.exports=function(t){var e=r();return function(){var n,r=i(t);if(e){var s=i(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return o(this,n)}},t.exports.__esModule=!0,t.exports.default=t.exports},3808:function(t){function e(n){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},1655:function(t,e,n){var i=n(6015);t.exports=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i(t,e)},t.exports.__esModule=!0,t.exports.default=t.exports},9617:function(t){t.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}},t.exports.__esModule=!0,t.exports.default=t.exports},9498:function(t){t.exports=function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports.default=t.exports},8872:function(t){t.exports=function(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);s=!0);}catch(h){a=!0,r=h}finally{try{s||null==n.return||n.return()}finally{if(a)throw r}}return o}},t.exports.__esModule=!0,t.exports.default=t.exports},2218:function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},2281:function(t){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},4993:function(t,e,n){var i=n(8698).default,r=n(6115);t.exports=function(t,e){if(e&&("object"===i(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return r(t)},t.exports.__esModule=!0,t.exports.default=t.exports},7061:function(t,e,n){var i=n(8698).default;function r(){"use strict";t.exports=r=function(){return e},t.exports.__esModule=!0,t.exports.default=t.exports;var e={},n=Object.prototype,o=n.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",h=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(P){l=function(t,e,n){return t[e]=n}}function c(t,e,n,i){var r=e&&e.prototype instanceof d?e:d,o=Object.create(r.prototype),s=new E(i||[]);return o._invoke=function(t,e,n){var i="suspendedStart";return function(r,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw o;return L()}for(n.method=r,n.arg=o;;){var s=n.delegate;if(s){var a=b(s,n);if(a){if(a===v)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var h=f(t,e,n);if("normal"===h.type){if(i=n.done?"completed":"suspendedYield",h.arg===v)continue;return{value:h.arg,done:n.done}}"throw"===h.type&&(i="completed",n.method="throw",n.arg=h.arg)}}}(t,n,s),o}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(P){return{type:"throw",arg:P}}}e.wrap=c;var v={};function d(){}function p(){}function y(){}var M={};l(M,a,(function(){return this}));var g=Object.getPrototypeOf,x=g&&g(g(A([])));x&&x!==n&&o.call(x,a)&&(M=x);var m=y.prototype=d.prototype=Object.create(M);function w(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(r,s,a,h){var u=f(t[r],t,s);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==i(c)&&o.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,a,h)}),(function(t){n("throw",t,a,h)})):e.resolve(c).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,h)}))}h(u.arg)}var r;this._invoke=function(t,i){function o(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(o,o):o()}}function b(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,b(t,e),"throw"===e.method))return v;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=f(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,v;var r=i.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,v):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function A(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(o.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:L}}function L(){return{value:void 0,done:!0}}return p.prototype=y,l(m,"constructor",y),l(y,"constructor",p),p.displayName=l(y,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,l(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(k.prototype),l(k.prototype,h,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,i,r,o){void 0===o&&(o=Promise);var s=new k(c(t,n,i,r),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},w(m),l(m,u,"Generator"),l(m,a,(function(){return this})),l(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=A,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,i){return s.type="throw",s.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],s=r.completion;if("root"===r.tryLoc)return n("end");if(r.tryLoc<=this.prev){var a=o.call(r,"catchLoc"),h=o.call(r,"finallyLoc");if(a&&h){if(this.prev<r.catchLoc)return n(r.catchLoc,!0);if(this.prev<r.finallyLoc)return n(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return n(r.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return n(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,v):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;T(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:A(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),v}},e}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},6015:function(t){function e(n,i){return t.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n,i)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},7424:function(t,e,n){var i=n(5372),r=n(8872),o=n(6116),s=n(2218);t.exports=function(t,e){return i(t)||r(t,e)||o(t,e)||s()},t.exports.__esModule=!0,t.exports.default=t.exports},861:function(t,e,n){var i=n(3405),r=n(9498),o=n(6116),s=n(2281);t.exports=function(t){return i(t)||r(t)||o(t)||s()},t.exports.__esModule=!0,t.exports.default=t.exports},8698:function(t){function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},6116:function(t,e,n){var i=n(3897);t.exports=function(t,e){if(t){if("string"===typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,n),o.exports}!function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){e=function(){return n};var n={},i=Object.prototype,r=i.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",h=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(L){u=function(t,e,n){return t[e]=n}}function l(t,e,n,i){var r=e&&e.prototype instanceof v?e:v,o=Object.create(r.prototype),s=new T(i||[]);return o._invoke=function(t,e,n){var i="suspendedStart";return function(r,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw o;return A()}for(n.method=r,n.arg=o;;){var s=n.delegate;if(s){var a=k(s,n);if(a){if(a===f)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var h=c(t,e,n);if("normal"===h.type){if(i=n.done?"completed":"suspendedYield",h.arg===f)continue;return{value:h.arg,done:n.done}}"throw"===h.type&&(i="completed",n.method="throw",n.arg=h.arg)}}}(t,n,s),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(L){return{type:"throw",arg:L}}}n.wrap=l;var f={};function v(){}function d(){}function p(){}var y={};u(y,s,(function(){return this}));var M=Object.getPrototypeOf,g=M&&M(M(E([])));g&&g!==i&&r.call(g,s)&&(y=g);var x=p.prototype=v.prototype=Object.create(y);function m(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(e,n){function i(o,s,a,h){var u=c(e[o],e,s);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==t(f)&&r.call(f,"__await")?n.resolve(f.__await).then((function(t){i("next",t,a,h)}),(function(t){i("throw",t,a,h)})):n.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return i("throw",t,a,h)}))}h(u.arg)}var o;this._invoke=function(t,e){function r(){return new n((function(n,r){i(t,e,n,r)}))}return o=o?o.then(r,r):r()}}function k(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,k(t,e),"throw"===e.method))return f;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var i=c(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,f;var r=i.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function b(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(b,this),this.reset(!0)}function E(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:A}}function A(){return{value:void 0,done:!0}}return d.prototype=p,u(x,"constructor",p),u(p,"constructor",d),d.displayName=u(p,h,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,h,"GeneratorFunction")),t.prototype=Object.create(x),t},n.awrap=function(t){return{__await:t}},m(w.prototype),u(w.prototype,a,(function(){return this})),n.AsyncIterator=w,n.async=function(t,e,i,r,o){void 0===o&&(o=Promise);var s=new w(l(t,e,i,r),o);return n.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},m(x),u(x,h,"Generator"),u(x,s,(function(){return this})),u(x,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},n.values=E,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,i){return s.type="throw",s.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),h=r.call(o,"finallyLoc");if(a&&h){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;_(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:E(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},n}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,e,n,i,r,o,s){try{var a=t[o](s),h=a.value}catch(u){return void n(u)}a.done?e(h):Promise.resolve(h).then(i,r)}var s=n(5547),a=12,h=1500,u=2e3,l=function(){var t,n=(t=e().mark((function t(){var n,o,l,c,f,v,d,p,y,M,g,x,m,w,k,b,_,T,E,A,L,P,C,S,O,R,I,V,F,G,D,z,j,B,N;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return N=function(t,e,n){d.begin(),d.draw(n?g:M,w*t,w*e,w,w),d.end()},B=function(){for(var t=0;t<24;t++)for(var e=0;e<a;e++)N(e,t,1===z[t][e]?1:0)},j=function(){for(var t=0;t<24;t++){z[t]=[];for(var e=0;e<a;e++)N(e,t,0),z[t][e]=0}},D=function(t,e){return Math.floor(Math.random()*(e-t))+t},G=function(t){37===t.keyCode?V.moveLeft():38===t.keyCode?V.rotate():39===t.keyCode?V.moveRight():40===t.keyCode&&(V.moveDown(),V.moveDown())},n=(0,s.createStage)(),o=n.getCanvas(),l=(0,s.createViewport)(o,h,u),c=l.getContext(),f=new s.BitmapFontData("./1231231.fnt",!0),t.next=12,f.loadFont(c);case 12:return f.setScale(3,3),v=new s.BitmapFont(f,f.regions,!0),d=new s.PolygonBatch(c),p=l.getCamera(),d.setYDown(!0),p.setYDown(!0),t.next=20,s.Texture.load(c,"./bg1.png");case 20:return y=t.sent,t.next=23,s.Texture.load(c,"./borderBlock.png");case 23:return M=t.sent,t.next=26,s.Texture.load(c,"./GreenBlock.png");case 26:return g=t.sent,t.next=29,s.Texture.load(c,"./gameover.png");case 29:return x=t.sent,t.next=32,s.Texture.load(c,"./temp.png");case 32:m=t.sent,w=83,k=0,b=0,_=!1,T=[[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]],E=[[[0,0,1],[1,1,1],[0,0,0]],[[0,1,0],[0,1,0],[0,1,1]],[[0,0,0],[1,1,1],[1,0,0]],[[1,1,0],[0,1,0],[0,1,0]]],A=[[[1,0,0],[1,1,1],[0,0,0]],[[0,1,1],[0,1,0],[0,1,0]],[[0,0,0],[1,1,1],[0,0,1]],[[0,1,0],[0,1,0],[1,1,0]]],L=[[[1,1],[1,1]]],P=[[[0,1,1],[1,1,0],[0,0,0]],[[0,1,0],[0,1,1],[0,0,1]]],C=[[[1,1,0],[0,1,1],[0,0,0]],[[0,0,1],[0,1,1],[0,1,0]]],S=[[[0,1,0],[1,1,1],[0,0,0]],[[0,1,0],[0,1,1],[0,1,0]],[[0,0,0],[1,1,1],[0,1,0]],[[0,1,0],[1,1,0],[0,1,0]]],O=.5,R=function(){function t(e,n){i(this,t),this.tetromino=void 0,this.color=void 0,this.tetrominoN=void 0,this.activeTetromino=void 0,this.temp=void 0,this.x=void 0,this.y=void 0,this.tetromino=e,this.tetrominoN=0,this.activeTetromino=this.tetromino[this.tetrominoN],this.x=4,this.y=0}var e,n,o;return e=t,(n=[{key:"fill",value:function(t){for(var e=0;e<this.activeTetromino.length;e++)for(var n=0;n<this.activeTetromino.length;n++)this.activeTetromino[e][n]&&N(this.x+n,this.y+e,t)}},{key:"draw",value:function(){this.fill(1)}},{key:"undraw",value:function(){this.fill(0)}},{key:"lock",value:function(){for(var t=0;t<this.activeTetromino.length;t++)for(var e=0;e<this.activeTetromino.length;e++)this.activeTetromino[t][e]&&(z[this.y+t][this.x+e]=1,this.y+t<1&&(_=!0));setTimeout((function(){for(var t=0;t<24;t++){for(var e=!0,n=0;n<a;n++)e=e&&0!==z[t][n];if(e){for(var i=t;i>1;i--)for(var r=0;r<a;r++)z[i][r]=z[i-1][r];for(var o=0;o<a;o++)z[0][o]=0;O>.15&&(O-=.05),b+=10}}}),200)}},{key:"collision",value:function(t,e,n){for(var i=0;i<n.length;i++)for(var r=0;r<n.length;r++)if(n[i][r]){var o=this.x+r+t,s=this.y+i+e;if(o<0||o>=a||s>=24)return!0;if(!(s<0)&&0!==z[s][o])return!0}return!1}},{key:"rotate",value:function(){var t=this.tetromino[(this.tetrominoN+1)%this.tetromino.length],e=0;this.collision(0,0,t)&&(e=this.x>6?-1:1),this.collision(e,0,t)||(this.undraw(),this.x+=e,this.tetrominoN=(this.tetrominoN+1)%this.tetromino.length,this.activeTetromino=this.tetromino[this.tetrominoN],this.draw())}},{key:"moveDown",value:function(){this.y>23&&(this.lock(),V=new t(F),F=I[D(0,7)]),this.collision(0,1,this.activeTetromino)?(this.lock(),V=new t(F),F=I[D(0,7)]):(this.undraw(),this.y++,this.draw())}},{key:"moveLeft",value:function(){this.collision(-1,0,this.activeTetromino)||(this.undraw(),this.x--,this.draw())}},{key:"moveRight",value:function(){this.collision(1,0,this.activeTetromino)||(this.undraw(),this.x++,this.draw())}},{key:"showNextTetromino",value:function(t){for(var e=0;e<t.length;e++)for(var n=0;n<t[e].length;n++)t[e][n]&&N(13.4+n,3.2+e,1)}}])&&r(e.prototype,n),o&&r(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}(),V=new R((I=[T,E,A,S,L,P,C])[4]),F=I[D(0,7)],window.addEventListener("keydown",(function(t){G(t),!0===_&&(O=.5,b=0,setTimeout((function(){j(),B(),_=!1}),300))})),z=[],j(),(0,s.createGameLoop)((function(t){c.clearColor(0,0,0,1),c.clear(c.COLOR_BUFFER_BIT),d.setProjection(p.projectionView.values),B(),d.begin(),d.draw(y,1e3,0,500,2e3),d.setColor(s.Color.WHITE),v.draw(d,"Score: "+b,1070,1500,h),d.draw(m,900,500,500,250),d.end(),V.fill(1),V.showNextTetromino(F[0]),_?(d.begin(),d.draw(x,-10,500,1e3,1e3),d.end()):(k+=t)>=O&&(k=0,V.moveDown())}));case 53:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(i,r){var s=t.apply(e,n);function a(t){o(s,i,r,a,h,"next",t)}function h(t){o(s,i,r,a,h,"throw",t)}a(void 0)}))});return function(){return n.apply(this,arguments)}}();l()}()}();
//# sourceMappingURL=main.d9b5a057.js.map